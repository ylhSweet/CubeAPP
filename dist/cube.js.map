{"version":3,"file":"cube.js","sources":["../src/js/utils/Animation.js","../src/js/World.js","../src/js/plugins/RoundedBoxGeometry.js","../src/js/Cube.js","../src/js/plugins/RoundedPlaneGeometry.js","../src/js/utils/Easing.js","../src/js/utils/Tween.js","../src/js/utils/Draggable.js","../src/js/Controls.js","../src/js/Scrambler.js","../src/js/Transition.js","../src/js/Timer.js","../src/js/Range.js","../src/js/Preferences.js","../src/js/Confetti.js","../src/js/Scores.js","../src/js/Storage.js","../src/js/Themes.js","../src/js/ThemeEditor.js","../src/js/States.js","../src/js/Icons.js","../src/js/Game.js"],"sourcesContent":["const animationEngine = ( () => {\n\n  let uniqueID = 0;\n\n  class AnimationEngine { //动画引擎\n\n    constructor() {\n\n      this.ids = [];\n      this.animations = {};\n      this.update = this.update.bind( this );\n      this.raf = 0;\n      this.time = 0;\n\n    }\n\n    update() {\n\n      const now = performance.now();\n      const delta = now - this.time\n      this.time = now;\n\n      let i = this.ids.length;\n\n      this.raf = i ? requestAnimationFrame( this.update ) : 0;\n\n      while ( i-- )\n        this.animations[ this.ids[ i ] ] && this.animations[ this.ids[ i ] ].update( delta );\n\n    }\n\n    add( animation ) {\n\n      animation.id = uniqueID ++;\n\n      this.ids.push( animation.id );\n      this.animations[ animation.id ] = animation;\n\n      if ( this.raf !== 0 ) return;\n\n      this.time = performance.now();\n      this.raf = requestAnimationFrame( this.update );\n\n    }\n\n    remove( animation ) {\n\n      const index = this.ids.indexOf( animation.id );\n\n      if ( index < 0 ) return;\n\n      this.ids.splice( index, 1 );\n      delete this.animations[ animation.id ];\n      animation = null;\n\n    }\n\n  }\n\n  return new AnimationEngine();\n\n} )();\n\n\nclass Animation {\n\n  constructor( start ) {\n\n    if ( start === true ) this.start();\n\n  }\n\n  start() {\n\n    animationEngine.add( this );\n\n  }\n\n  stop() {\n\n    animationEngine.remove( this );\n\n  }\n\n  update( delta ) {}\n\n}\n\nexport { Animation };\n","import { Animation } from './utils/Animation.js';\n\nclass World extends Animation {\n\n\tconstructor(game) {\n\n\t\tsuper(true);\n\n\t\tthis.game = game;\n\n\t\tthis.container = this.game.dom.game;\n\t\tthis.scene = new THREE.Scene(); //场景\n\n\t\tthis.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true }); //渲染器\n\t\tthis.renderer.setPixelRatio(window.devicePixelRatio); //设置设备像素比\n\t\tthis.container.appendChild(this.renderer.domElement);\n\n\t\tthis.camera = new THREE.PerspectiveCamera(2, 1, 0.1, 10000); //相机\n\n\t\tthis.stage = { width: 2, height: 3 };\n\t\tthis.fov = 10; //视角\n\n\t\tthis.createLights();\n\n\t\tthis.onResize = [];\n\n\t\tthis.resize();\n\t\twindow.addEventListener('resize', () => this.resize(), false);\n\n\t}\n\n\tupdate() {\n\n\t\tthis.renderer.render(this.scene, this.camera);\n\n\t}\n\n\tresize() {\n\n\t\tthis.width = this.container.offsetWidth;\n\t\tthis.height = this.container.offsetHeight;\n\n\t\tthis.renderer.setSize(this.width, this.height); //设置渲染器宽度和高度\n\n\t\tthis.camera.fov = this.fov; //相机视角\n\t\tthis.camera.aspect = this.width / this.height; //裁切面宽高比\n\n\t\tconst aspect = this.stage.width / this.stage.height;\n\t\tconst fovRad = this.fov * THREE.Math.DEG2RAD;\n\n\t\tlet distance = (aspect < this.camera.aspect)\n\t\t\t? (this.stage.height / 2) / Math.tan(fovRad / 2)\n\t\t\t: (this.stage.width / this.camera.aspect) / (2 * Math.tan(fovRad / 2));\n\n\t\tdistance *= 0.5;\n\n\t\tthis.camera.position.set(distance, distance, distance);\n\t\tthis.camera.lookAt(this.scene.position);\n\t\t// 动态修改正交相机属性，修改后需调用updateProjectionMatrix()方法更新相机显存里的内容\n\t\tthis.camera.updateProjectionMatrix();\n\n\t\tconst docFontSize = (aspect < this.camera.aspect)\n\t\t\t? (this.height / 100) * aspect\n\t\t\t: this.width / 100;\n\n\t\tdocument.documentElement.style.fontSize = docFontSize + 'px';\n\n\t\tif (this.onResize) this.onResize.forEach(cb => cb());\n\n\t}\n\n\tcreateLights() {\n\n\t\tthis.lights = {\n\t\t\tholder: new THREE.Object3D, //三维物体\n\t\t\tambient: new THREE.AmbientLight(0xffffff, 0.69), // 环境光\n\t\t\tfront: new THREE.DirectionalLight(0xffffff, 0.36), //方向光源（颜色白色，光照强度）\n\t\t\tback: new THREE.DirectionalLight(0xffffff, 0.19),\n\t\t};\n\t\t// 位置\n\t\tthis.lights.front.position.set(1.5, 5, 3);\n\t\tthis.lights.back.position.set(-1.5, -5, -3);\n\n\t\tthis.lights.holder.add(this.lights.ambient);\n\t\tthis.lights.holder.add(this.lights.front);\n\t\tthis.lights.holder.add(this.lights.back);\n\n\t\tthis.scene.add(this.lights.holder);\n\n\t}\n\n}\n\nexport { World };\n","function RoundedBoxGeometry( size, radius, radiusSegments ) {\n\n  THREE.BufferGeometry.call( this );\n\n  this.type = 'RoundedBoxGeometry';\n\n  radiusSegments = ! isNaN( radiusSegments ) ? Math.max( 1, Math.floor( radiusSegments ) ) : 1;\n\n  var width, height, depth;\n\n  width = height = depth = size;\n  radius = size * radius;\n\n  radius = Math.min( radius, Math.min( width, Math.min( height, Math.min( depth ) ) ) / 2 );\n\n  var edgeHalfWidth = width / 2 - radius;\n  var edgeHalfHeight = height / 2 - radius;\n  var edgeHalfDepth = depth / 2 - radius;\n\n  this.parameters = {\n    width: width,\n    height: height,\n    depth: depth,\n    radius: radius,\n    radiusSegments: radiusSegments\n  };\n\n  var rs1 = radiusSegments + 1;\n  var totalVertexCount = ( rs1 * radiusSegments + 1 ) << 3;\n\n  var positions = new THREE.BufferAttribute( new Float32Array( totalVertexCount * 3 ), 3 );\n  var normals = new THREE.BufferAttribute( new Float32Array( totalVertexCount * 3 ), 3 );\n\n  var\n    cornerVerts = [],\n    cornerNormals = [],\n    normal = new THREE.Vector3(),\n    vertex = new THREE.Vector3(),\n    vertexPool = [],\n    normalPool = [],\n    indices = []\n  ;\n\n  var\n    lastVertex = rs1 * radiusSegments,\n    cornerVertNumber = rs1 * radiusSegments + 1\n  ;\n\n  doVertices();\n  doFaces();\n  doCorners();\n  doHeightEdges();\n  doWidthEdges();\n  doDepthEdges();\n  // 计算垂直位置\n  function doVertices() {\n\n    var cornerLayout = [\n      new THREE.Vector3( 1, 1, 1 ),\n      new THREE.Vector3( 1, 1, - 1 ),\n      new THREE.Vector3( - 1, 1, - 1 ),\n      new THREE.Vector3( - 1, 1, 1 ),\n      new THREE.Vector3( 1, - 1, 1 ),\n      new THREE.Vector3( 1, - 1, - 1 ),\n      new THREE.Vector3( - 1, - 1, - 1 ),\n      new THREE.Vector3( - 1, - 1, 1 )\n    ];\n\n    for ( var j = 0; j < 8; j ++ ) {\n\n      cornerVerts.push( [] );\n      cornerNormals.push( [] );\n\n    }\n\n    var PIhalf = Math.PI / 2;\n    var cornerOffset = new THREE.Vector3( edgeHalfWidth, edgeHalfHeight, edgeHalfDepth );\n\n    for ( var y = 0; y <= radiusSegments; y ++ ) {\n\n      var v = y / radiusSegments;\n      var va = v * PIhalf;\n      var cosVa = Math.cos( va );\n      var sinVa = Math.sin( va );\n\n      if ( y == radiusSegments ) {\n\n        vertex.set( 0, 1, 0 );\n        var vert = vertex.clone().multiplyScalar( radius ).add( cornerOffset );\n        cornerVerts[ 0 ].push( vert );\n        vertexPool.push( vert );\n        var norm = vertex.clone();\n        cornerNormals[ 0 ].push( norm );\n        normalPool.push( norm );\n        continue;\n\n      }\n\n      for ( var x = 0; x <= radiusSegments; x ++ ) {\n\n        var u = x / radiusSegments;\n        var ha = u * PIhalf;\n        vertex.x = cosVa * Math.cos( ha );\n        vertex.y = sinVa;\n        vertex.z = cosVa * Math.sin( ha );\n\n        var vert = vertex.clone().multiplyScalar( radius ).add( cornerOffset );\n        cornerVerts[ 0 ].push( vert );\n        vertexPool.push( vert );\n\n        var norm = vertex.clone().normalize();\n        cornerNormals[ 0 ].push( norm );\n        normalPool.push( norm );\n\n      }\n\n    }\n\n    for ( var i = 1; i < 8; i ++ ) {\n\n      for ( var j = 0; j < cornerVerts[ 0 ].length; j ++ ) {\n\n        var vert = cornerVerts[ 0 ][ j ].clone().multiply( cornerLayout[ i ] );\n        cornerVerts[ i ].push( vert );\n        vertexPool.push( vert );\n\n        var norm = cornerNormals[ 0 ][ j ].clone().multiply( cornerLayout[ i ] );\n        cornerNormals[ i ].push( norm );\n        normalPool.push( norm );\n\n      }\n\n    }\n\n  }\n\n  function doCorners() {\n\n    var indexInd = 0;\n\n    var flips = [\n      true,\n      false,\n      true,\n      false,\n      false,\n      true,\n      false,\n      true\n    ];\n\n    var lastRowOffset = rs1 * ( radiusSegments - 1 );\n\n    for ( var i = 0; i < 8; i ++ ) {\n\n      var cornerOffset = cornerVertNumber * i;\n\n      for ( var v = 0; v < radiusSegments - 1; v ++ ) {\n\n        var r1 = v * rs1;\n        var r2 = ( v + 1 ) * rs1;\n\n        for ( var u = 0; u < radiusSegments; u ++ ) {\n\n          var u1 = u + 1;\n          var a = cornerOffset + r1 + u;\n          var b = cornerOffset + r1 + u1;\n          var c = cornerOffset + r2 + u;\n          var d = cornerOffset + r2 + u1;\n\n          if ( ! flips[ i ] ) {\n\n            indices.push( a );\n            indices.push( b );\n            indices.push( c );\n\n            indices.push( b );\n            indices.push( d );\n            indices.push( c );\n\n          } else {\n\n            indices.push( a );\n            indices.push( c );\n            indices.push( b );\n\n            indices.push( b );\n            indices.push( c );\n            indices.push( d );\n\n          }\n\n        }\n\n      }\n\n      for ( var u = 0; u < radiusSegments; u ++ ) {\n\n        var a = cornerOffset + lastRowOffset + u;\n        var b = cornerOffset + lastRowOffset + u + 1;\n        var c = cornerOffset + lastVertex;\n\n        if ( ! flips[ i ] ) {\n\n          indices.push( a );\n          indices.push( b );\n          indices.push( c );\n\n        } else {\n\n          indices.push( a );\n          indices.push( c );\n          indices.push( b );\n\n        }\n\n      }\n\n    }\n\n  }\n\n  function doFaces() {\n\n    var a = lastVertex;\n    var b = lastVertex + cornerVertNumber;\n    var c = lastVertex + cornerVertNumber * 2;\n    var d = lastVertex + cornerVertNumber * 3;\n\n    indices.push( a );\n    indices.push( b );\n    indices.push( c );\n    indices.push( a );\n    indices.push( c );\n    indices.push( d );\n\n    a = lastVertex + cornerVertNumber * 4;\n    b = lastVertex + cornerVertNumber * 5;\n    c = lastVertex + cornerVertNumber * 6;\n    d = lastVertex + cornerVertNumber * 7;\n\n    indices.push( a );\n    indices.push( c );\n    indices.push( b );\n    indices.push( a );\n    indices.push( d );\n    indices.push( c );\n\n    a = 0;\n    b = cornerVertNumber;\n    c = cornerVertNumber * 4;\n    d = cornerVertNumber * 5;\n\n    indices.push( a );\n    indices.push( c );\n    indices.push( b );\n    indices.push( b );\n    indices.push( c );\n    indices.push( d );\n\n    a = cornerVertNumber * 2;\n    b = cornerVertNumber * 3;\n    c = cornerVertNumber * 6;\n    d = cornerVertNumber * 7;\n\n    indices.push( a );\n    indices.push( c );\n    indices.push( b );\n    indices.push( b );\n    indices.push( c );\n    indices.push( d );\n\n    a = radiusSegments;\n    b = radiusSegments + cornerVertNumber * 3;\n    c = radiusSegments + cornerVertNumber * 4;\n    d = radiusSegments + cornerVertNumber * 7;\n\n    indices.push( a );\n    indices.push( b );\n    indices.push( c );\n    indices.push( b );\n    indices.push( d );\n    indices.push( c );\n\n    a = radiusSegments + cornerVertNumber;\n    b = radiusSegments + cornerVertNumber * 2;\n    c = radiusSegments + cornerVertNumber * 5;\n    d = radiusSegments + cornerVertNumber * 6;\n\n    indices.push( a );\n    indices.push( c );\n    indices.push( b );\n    indices.push( b );\n    indices.push( c );\n    indices.push( d );\n\n  }\n\n  function doHeightEdges() {\n\n    for ( var i = 0; i < 4; i ++ ) {\n\n      var cOffset = i * cornerVertNumber;\n      var cRowOffset = 4 * cornerVertNumber + cOffset;\n      var needsFlip = i & 1 === 1;\n\n      for ( var u = 0; u < radiusSegments; u ++ ) {\n\n        var u1 = u + 1;\n        var a = cOffset + u;\n        var b = cOffset + u1;\n        var c = cRowOffset + u;\n        var d = cRowOffset + u1;\n\n        if ( ! needsFlip ) {\n\n          indices.push( a );\n          indices.push( b );\n          indices.push( c );\n          indices.push( b );\n          indices.push( d );\n          indices.push( c );\n\n        } else {\n\n          indices.push( a );\n          indices.push( c );\n          indices.push( b );\n          indices.push( b );\n          indices.push( c );\n          indices.push( d );\n\n        }\n\n      }\n\n    }\n\n  }\n\n  function doDepthEdges() {\n\n    var cStarts = [ 0, 2, 4, 6 ];\n    var cEnds = [ 1, 3, 5, 7 ];\n\n    for ( var i = 0; i < 4; i ++ ) {\n\n      var cStart = cornerVertNumber * cStarts[ i ];\n      var cEnd = cornerVertNumber * cEnds[ i ];\n\n      var needsFlip = 1 >= i;\n\n      for ( var u = 0; u < radiusSegments; u ++ ) {\n\n        var urs1 = u * rs1;\n        var u1rs1 = ( u + 1 ) * rs1;\n\n        var a = cStart + urs1;\n        var b = cStart + u1rs1;\n        var c = cEnd + urs1;\n        var d = cEnd + u1rs1;\n\n        if ( needsFlip ) {\n\n          indices.push( a );\n          indices.push( c );\n          indices.push( b );\n          indices.push( b );\n          indices.push( c );\n          indices.push( d );\n\n        } else {\n\n          indices.push( a );\n          indices.push( b );\n          indices.push( c );\n          indices.push( b );\n          indices.push( d );\n          indices.push( c );\n\n        }\n\n      }\n\n    }\n\n  }\n\n  function doWidthEdges() {\n\n    var end = radiusSegments - 1;\n\n    var cStarts = [ 0, 1, 4, 5 ];\n    var cEnds = [ 3, 2, 7, 6 ];\n    var needsFlip = [ 0, 1, 1, 0 ];\n\n    for ( var i = 0; i < 4; i ++ ) {\n\n      var cStart = cStarts[ i ] * cornerVertNumber;\n      var cEnd = cEnds[ i ] * cornerVertNumber;\n\n      for ( var u = 0; u <= end; u ++ ) {\n\n        var a = cStart + radiusSegments + u * rs1;\n        var b = cStart + ( u != end ? radiusSegments + ( u + 1 ) * rs1 : cornerVertNumber - 1 );\n\n        var c = cEnd + radiusSegments + u * rs1;\n        var d = cEnd + ( u != end ? radiusSegments + ( u + 1 ) * rs1 : cornerVertNumber - 1 );\n\n        if ( ! needsFlip[ i ] ) {\n\n          indices.push( a );\n          indices.push( b );\n          indices.push( c );\n          indices.push( b );\n          indices.push( d );\n          indices.push( c );\n\n        } else {\n\n          indices.push( a );\n          indices.push( c );\n          indices.push( b );\n          indices.push( b );\n          indices.push( c );\n          indices.push( d );\n\n        }\n\n      }\n\n    }\n\n  }\n\n  var index = 0;\n\n  for ( var i = 0; i < vertexPool.length; i ++ ) {\n\n    positions.setXYZ(\n      index,\n      vertexPool[ i ].x,\n      vertexPool[ i ].y,\n      vertexPool[ i ].z\n    );\n\n    normals.setXYZ(\n      index,\n      normalPool[ i ].x,\n      normalPool[ i ].y,\n      normalPool[ i ].z\n    );\n\n    index ++;\n\n  }\n\n  this.setIndex( new THREE.BufferAttribute( new Uint16Array( indices ), 1 ) );\n  this.addAttribute( 'position', positions );\n  this.addAttribute( 'normal', normals );\n\n}\n\nRoundedBoxGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\nRoundedBoxGeometry.constructor = RoundedBoxGeometry;\n\nexport { RoundedBoxGeometry };\n","import { RoundedBoxGeometry } from './plugins/RoundedBoxGeometry.js';\nimport { RoundedPlaneGeometry } from './plugins/RoundedPlaneGeometry.js';\n\nclass Cube {\n\n\tconstructor(game) {\n\n\t\tthis.game = game;\n\t\tthis.size = 3;\n\n\t\tthis.geometry = { //魔方内体的参数\n\t\t\tpieceCornerRadius: 0.01, //黑色角块的弧度\n\t\t\tedgeCornerRoundness: 0, //外层颜色层的角度\n\t\t\tedgeScale: 0.9, //外层颜色层占的比例\n\t\t\tedgeDepth: 0.001, //外层颜色层的高度\n\t\t};\n\n\t\tthis.holder = new THREE.Object3D();\n\t\tthis.object = new THREE.Object3D();\n\t\tthis.animator = new THREE.Object3D();\n\n\t\tthis.holder.add(this.animator);\n\t\tthis.animator.add(this.object);\n\n\t\tthis.game.world.scene.add(this.holder);\n\n\t}\n\n\tinit() {\n\n\t\tthis.cubes = [];\n\t\tthis.object.children = [];\n\t\tthis.object.add(this.game.controls.group);\n\n\t\tif (this.size === 2) this.scale = 1.25;\n\t\telse if (this.size === 3) this.scale = 1;\n\t\telse if (this.size > 3) this.scale = 3 / this.size;\n\n\t\tthis.object.scale.set(this.scale, this.scale, this.scale);\n\n\t\tconst controlsScale = this.size === 2 ? 0.825 : 1;\n\t\tthis.game.controls.edges.scale.set(controlsScale, controlsScale, controlsScale);\n\n\t\tthis.generatePositions();\n\t\tthis.generateModel();\n\n\t\tthis.pieces.forEach(piece => {\n\n\t\t\tthis.cubes.push(piece.userData.cube);\n\t\t\tthis.object.add(piece);\n\n\t\t});\n\n\t\tthis.holder.traverse(node => {\n\n\t\t\tif (node.frustumCulled) node.frustumCulled = false;\n\n\t\t});\n\n\t\tthis.updateColors(this.game.themes.getColors());\n\n\t\tthis.sizeGenerated = this.size;\n\n\t}\n\t// 阶数调整\n\tresize(force = false) {\n\n\t\tif (this.size !== this.sizeGenerated || force) {\n\n\t\t\tthis.size = this.game.preferences.ranges.size.value;\n\n\t\t\tthis.reset();\n\t\t\tthis.init();\n\n\t\t\tthis.game.saved = false;\n\t\t\tthis.game.timer.reset();\n\t\t\tthis.game.storage.clearGame();\n\n\t\t}\n\n\t}\n\t// 重置\n\treset() {\n\t\tthis.game.controls.edges.rotation.set(0, 0, 0);\n\t\tthis.holder.rotation.set(0, 0, 0);\n\t\tthis.object.rotation.set(0, 0, 0);\n\t\tthis.animator.rotation.set(0, 0, 0);\n\n\t}\n\t// 生成位置\n\tgeneratePositions() {\n\n\t\tconst m = this.size - 1;\n\t\tconst first = this.size % 2 !== 0\n\t\t\t? 0 - Math.floor(this.size / 2)\n\t\t\t: 0.5 - this.size / 2;\n\n\t\tlet x, y, z;\n\n\t\tthis.positions = [];\n\n\t\tfor (x = 0; x < this.size; x++) {\n\t\t\tfor (y = 0; y < this.size; y++) {\n\t\t\t\tfor (z = 0; z < this.size; z++) {\n\n\t\t\t\t\tlet position = new THREE.Vector3(first + x, first + y, first + z);\n\t\t\t\t\tlet edges = [];\n\n\t\t\t\t\tif (x == 0) edges.push(0);\n\t\t\t\t\tif (x == m) edges.push(1);\n\t\t\t\t\tif (y == 0) edges.push(2);\n\t\t\t\t\tif (y == m) edges.push(3);\n\t\t\t\t\tif (z == 0) edges.push(4);\n\t\t\t\t\tif (z == m) edges.push(5);\n\n\t\t\t\t\tposition.edges = edges;\n\t\t\t\t\tthis.positions.push(position);\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n\t// 生成模型\n\tgenerateModel() {\n\n\t\tthis.pieces = [];\n\t\tthis.edges = [];\n\n\t\tconst pieceSize = 1 / 3;\n\n\t\tconst mainMaterial = new THREE.MeshBasicMaterial(); //MeshBasicMaterial  MeshLambertMaterial\n\n\t\tconst pieceMesh = new THREE.Mesh(\n\t\t\tnew RoundedBoxGeometry(pieceSize, this.geometry.pieceCornerRadius, 3),\n\t\t\tmainMaterial.clone()\n\t\t);\n\n\t\tconst edgeGeometry = RoundedPlaneGeometry(\n\t\t\tpieceSize,\n\t\t\tthis.geometry.edgeCornerRoundness,\n\t\t\tthis.geometry.edgeDepth\n\t\t);\n\n\t\tthis.positions.forEach((position, index) => {\n\n\t\t\tconst piece = new THREE.Object3D();\n\t\t\tconst pieceCube = pieceMesh.clone();\n\t\t\tconst pieceEdges = [];\n\n\t\t\tpiece.position.copy(position.clone().divideScalar(3));\n\t\t\tpiece.add(pieceCube);\n\t\t\tpiece.name = index;\n\t\t\tpiece.edgesName = '';\n\n\t\t\tposition.edges.forEach(position => {\n\n\t\t\t\tconst edge = new THREE.Mesh(edgeGeometry, mainMaterial.clone());\n\t\t\t\t// 左面，右面，下面，上面，后面，前面\n\t\t\t\tconst name = ['L', 'R', 'D', 'U', 'B', 'F'][position];\n\t\t\t\tconst distance = pieceSize / 2;\n\n\t\t\t\tedge.position.set(\n\t\t\t\t\tdistance * [- 1, 1, 0, 0, 0, 0][position],\n\t\t\t\t\tdistance * [0, 0, - 1, 1, 0, 0][position],\n\t\t\t\t\tdistance * [0, 0, 0, 0, - 1, 1][position]\n\t\t\t\t);\n\n\t\t\t\tedge.rotation.set(\n\t\t\t\t\tMath.PI / 2 * [0, 0, 1, - 1, 0, 0][position],\n\t\t\t\t\tMath.PI / 2 * [- 1, 1, 0, 0, 2, 0][position],\n\t\t\t\t\t0\n\t\t\t\t);\n\n\t\t\t\tedge.scale.set(\n\t\t\t\t\tthis.geometry.edgeScale,\n\t\t\t\t\tthis.geometry.edgeScale,\n\t\t\t\t\tthis.geometry.edgeScale\n\t\t\t\t);\n\n\t\t\t\tedge.name = name;\n\n\t\t\t\tpiece.add(edge);\n\t\t\t\tpieceEdges.push(name);\n\t\t\t\tthis.edges.push(edge);\n\n\t\t\t});\n\n\t\t\tpiece.userData.edges = pieceEdges;\n\t\t\tpiece.userData.cube = pieceCube;\n\n\t\t\tpiece.userData.start = {\n\t\t\t\tposition: piece.position.clone(),\n\t\t\t\trotation: piece.rotation.clone(),\n\t\t\t};\n\n\t\t\tthis.pieces.push(piece);\n\n\t\t});\n\n\t}\n\n\tupdateColors(colors) {\n\t\tif (typeof this.pieces !== 'object' && typeof this.edges !== 'object') return;\n\n\t\tthis.pieces.forEach(piece => piece.userData.cube.material.color.setHex(colors.P));\n\t\tthis.edges.forEach(edge => edge.material.color.setHex(colors[edge.name]));\n\n\t}\n\n\tloadFromData(data) {\n\t\tthis.size = data.size;\n\n\t\tthis.reset();\n\t\tthis.init();\n\n\t\tthis.pieces.forEach(piece => {\n\t\t\tconst index = data.names.indexOf(piece.name);\n\n\t\t\tconst position = data.positions[index];\n\t\t\tconst rotation = data.rotations[index];\n\n\t\t\tpiece.position.set(position.x, position.y, position.z);\n\t\t\tpiece.rotation.set(rotation.x, rotation.y, rotation.z);\n\n\t\t});\n\n\t}\n\n}\n\nexport { Cube };\n","function RoundedPlaneGeometry( size, radius, depth ) {\n\n  var x, y, width, height;\n\n  x = y = - size / 2;\n  width = height = size;\n  radius = size * radius;\n\n  const shape = new THREE.Shape();\n\n  shape.moveTo( x, y + radius );\n  shape.lineTo( x, y + height - radius );\n  shape.quadraticCurveTo( x, y + height, x + radius, y + height );\n  shape.lineTo( x + width - radius, y + height );\n  shape.quadraticCurveTo( x + width, y + height, x + width, y + height - radius );\n  shape.lineTo( x + width, y + radius );\n  shape.quadraticCurveTo( x + width, y, x + width - radius, y );\n  shape.lineTo( x + radius, y );\n  shape.quadraticCurveTo( x, y, x, y + radius );\n  // curveSegments 曲线分段数\n  // bevelEnabled 对挤出的形状应用是否斜角\n  // depth 挤出形状的深度\n  const geometry = new THREE.ExtrudeBufferGeometry(\n    shape,\n    { depth: depth, bevelEnabled: false, curveSegments: 12 }\n  );\n\n  return geometry;\n\n}\n\nexport { RoundedPlaneGeometry };\n","const Easing = { //动画缓冲\n  //乘方缓冲\n  Power: { \n\n    In: power => {\n      power = Math.round( power || 1 );\n      return t => Math.pow( t, power );\n    },\n\n    Out: power => {\n      power = Math.round( power || 1 );\n      return t => 1 - Math.abs( Math.pow( t - 1, power ) );\n    },\n\n    InOut: power => {\n      power = Math.round( power || 1 );\n      return t => ( t < 0.5 )\n        ? Math.pow( t * 2, power ) / 2\n        : ( 1 - Math.abs( Math.pow( ( t * 2 - 1 ) - 1, power ) ) ) / 2 + 0.5;\n    },\n\n  },\n  //正弦缓冲\n  Sine: {\n\n    In: () => t => 1 + Math.sin( Math.PI / 2 * t - Math.PI / 2 ),\n\n    Out: () => t => Math.sin( Math.PI / 2 * t ),\n\n    InOut: () => t => ( 1 + Math.sin( Math.PI * t - Math.PI / 2 ) ) / 2,\n  },\n  //倒退缓冲\n  Back: {\n\n    Out: s => {\n      s = s || 1.70158;\n      return t => { return ( t -= 1 ) * t * ( ( s + 1 ) * t + s ) + 1; };\n    },\n\n    In: s => {\n      s = s || 1.70158;\n      return t => { return t * t * ( ( s + 1 ) * t - s ); };\n    }\n\n  },\n  //伸缩缓冲\n  Elastic: {\n\n    Out: ( amplitude, period ) => {\n      let PI2 = Math.PI * 2;\n      let p1 = ( amplitude >= 1 ) ? amplitude : 1;\n      let p2 = ( period || 0.3 ) / ( amplitude < 1 ? amplitude : 1 );\n      let p3 = p2 / PI2 * ( Math.asin( 1 / p1 ) || 0 );\n      p2 = PI2 / p2;\n      return t => { return p1 * Math.pow( 2, -10 * t ) * Math.sin( ( t - p3 ) * p2 ) + 1 }\n    },\n\n  },\n\n};\n\nexport { Easing };\n","import { Animation } from './Animation.js';\nimport { Easing } from './Easing.js';\n\nclass Tween extends Animation {\n\n  constructor( options ) {\n\n    super( false );\n\n    this.duration = options.duration || 500;\n    this.easing = options.easing || ( t => t );\n    this.onUpdate = options.onUpdate || ( () => {} );\n    this.onComplete = options.onComplete || ( () => {} );\n\n    this.delay = options.delay || false;\n    this.yoyo = options.yoyo ? false : null;\n\n    this.progress = 0;\n    this.value = 0;\n    this.delta = 0;\n\n    this.getFromTo( options );\n\n    if ( this.delay ) setTimeout( () => super.start(), this.delay );\n    else super.start(); //开始动画前的回调函数\n \n    this.onUpdate( this ); //tween每次被更新后执行\n\n  }\n\n  update( delta ) {\n\n    const old = this.value * 1;\n    const direction = ( this.yoyo === true ) ? - 1 : 1;\n\n    this.progress += ( delta / this.duration ) * direction;\n\n    this.value = this.easing( this.progress );\n    this.delta = this.value - old;\n\n    if ( this.values !== null ) this.updateFromTo();\n\n    if ( this.yoyo !== null ) this.updateYoyo();\n    else if ( this.progress <= 1 ) this.onUpdate( this );\n    else {\n\n      this.progress = 1;\n      this.value = 1;\n      this.onUpdate( this );\n      this.onComplete( this ); //tween动画全部结束后执行\n      super.stop(); //结束动画后的回调函数\n\n    }\n\n  }\n\n  updateYoyo() {\n\n    if ( this.progress > 1 || this.progress < 0 ) {\n\n      this.value = this.progress = ( this.progress > 1 ) ? 1 : 0;\n      this.yoyo = ! this.yoyo;\n\n    }\n\n    this.onUpdate( this )\n\n  }\n\n  updateFromTo() {\n\n    this.values.forEach( key => {\n\n      this.target[ key ] = this.from[ key ] + ( this.to[ key ] - this.from[ key ] ) * this.value;\n\n    } );\n\n  }\n\n  getFromTo( options ) {\n\n    if ( ! options.target || ! options.to ) {\n\n      this.values = null;\n      return;\n\n    }\n\n    this.target = options.target || null;\n    this.from = options.from || {};\n    this.to = options.to || null;\n    this.values = [];\n\n    if ( Object.keys( this.from ).length < 1 )\n      Object.keys( this.to ).forEach( key => { this.from[ key ] = this.target[ key ]; } );\n\n    Object.keys( this.to ).forEach( key => { this.values.push( key ) } );\n\n  }\n\n}\n\nexport { Tween, Easing };\n","window.addEventListener( 'touchmove', () => {} );\ndocument.addEventListener( 'touchmove',  event => { event.preventDefault(); }, { passive: false } );\n\nclass Draggable { //拖放\n\n  constructor( element, options ) {\n\n    this.position = {\n      current: new THREE.Vector2(),\n      start: new THREE.Vector2(),\n      delta: new THREE.Vector2(),\n      old: new THREE.Vector2(),\n      drag: new THREE.Vector2(),\n    };\n\n    this.options = Object.assign( {\n      calcDelta: false,\n    }, options || {} );\n\n    this.element = element;\n    this.touch = null;\n\n    this.drag = {\n\n      start: ( event ) => {\n\n        if ( event.type == 'mousedown' && event.which != 1 ) return;\n        if ( event.type == 'touchstart' && event.touches.length > 1 ) return;\n\n        this.getPositionCurrent( event );\n\n        if ( this.options.calcDelta ) {\n\n          this.position.start = this.position.current.clone();\n          this.position.delta.set( 0, 0 );\n          this.position.drag.set( 0, 0 );\n\n        }\n\n        this.touch = ( event.type == 'touchstart' );\n\n        this.onDragStart( this.position );\n\n        window.addEventListener( ( this.touch ) ? 'touchmove' : 'mousemove', this.drag.move, false );\n        window.addEventListener( ( this.touch ) ? 'touchend' : 'mouseup', this.drag.end, false );\n\n      },\n\n      move: ( event ) => {\n\n        if ( this.options.calcDelta ) {\n\n          this.position.old = this.position.current.clone();\n\n        }\n\n        this.getPositionCurrent( event );\n\n        if ( this.options.calcDelta ) {\n\n          this.position.delta = this.position.current.clone().sub( this.position.old );\n          this.position.drag = this.position.current.clone().sub( this.position.start );\n\n        }\n\n        this.onDragMove( this.position );\n\n      },\n\n      end: ( event ) => {\n\n        this.getPositionCurrent( event );\n\n        this.onDragEnd( this.position );\n\n        window.removeEventListener( ( this.touch ) ? 'touchmove' : 'mousemove', this.drag.move, false );\n        window.removeEventListener( ( this.touch ) ? 'touchend' : 'mouseup', this.drag.end, false );\n\n      },\n\n    };\n\n    this.onDragStart = () => {};\n    this.onDragMove = () => {};\n    this.onDragEnd = () => {};\n\n    this.enable();\n\n    return this;\n\n  }\n\n  enable() {\n\n    this.element.addEventListener( 'touchstart', this.drag.start, false );\n    this.element.addEventListener( 'mousedown', this.drag.start, false );\n\n    return this;\n\n  }\n\n  disable() {\n\n    this.element.removeEventListener( 'touchstart', this.drag.start, false );\n    this.element.removeEventListener( 'mousedown', this.drag.start, false );\n\n    return this;\n\n  }\n\n  getPositionCurrent( event ) {\n\n    const dragEvent = event.touches\n      ? ( event.touches[ 0 ] || event.changedTouches[ 0 ] )\n      : event;\n\n    this.position.current.set( dragEvent.pageX, dragEvent.pageY );\n\n  }\n\n  convertPosition( position ) {\n\n    position.x = ( position.x / this.element.offsetWidth ) * 2 - 1;\n    position.y = - ( ( position.y / this.element.offsetHeight ) * 2 - 1 );\n\n    return position;\n\n  }\n\n}\n\nexport { Draggable };\n","import { Tween, Easing } from './utils/Tween.js';\nimport { Draggable } from './utils/Draggable.js';\n\nconst STILL = 0;\nconst PREPARING = 1;\nconst ROTATING = 2;\nconst ANIMATING = 3;\n\nclass Controls {\n\n  constructor(game) {\n\n    this.game = game;\n\n    this.flipConfig = 0;\n\n    this.flipEasings = [Easing.Power.Out(3), Easing.Sine.Out(), Easing.Back.Out(1.5)]; //转动时的缓冲方式\n    this.flipSpeeds = [125, 200, 300]; //转动的速度\n\n    this.raycaster = new THREE.Raycaster(); //光线投射\n\n    const helperMaterial = new THREE.MeshBasicMaterial({ depthWrite: false, transparent: true, opacity: 0, color: 0x0033ff });\n\n    this.group = new THREE.Object3D(); //三维物体\n    this.group.name = 'controls';\n    this.game.cube.object.add(this.group);\n\n    this.helper = new THREE.Mesh(\n      new THREE.PlaneBufferGeometry(200, 200),\n      helperMaterial.clone()\n    );\n\n    this.helper.rotation.set(0, Math.PI / 4, 0);\n    this.game.world.scene.add(this.helper);\n\n    this.edges = new THREE.Mesh(\n      new THREE.BoxBufferGeometry(1, 1, 1),\n      helperMaterial.clone(),\n    );\n    this.game.world.scene.add(this.edges);\n\n    this.onSolved = () => { };\n    this.onMove = () => { };\n\n    this.momentum = [];\n\n    this.scramble = null;\n    this.state = STILL;\n    this.enabled = false;\n\n    this.initDraggable();\n\n  }\n\n  enable() {\n\n    this.draggable.enable();\n    this.enabled = true;\n\n  }\n\n  disable() {\n\n    this.draggable.disable();\n    this.enabled = false;\n\n  }\n\n  initDraggable() {\n\n    this.draggable = new Draggable(this.game.dom.game);\n\n    this.draggable.onDragStart = position => {\n\n      if (this.scramble !== null) return;\n      if (this.state === PREPARING || this.state === ROTATING) return;\n\n      this.gettingDrag = this.state === ANIMATING;\n\n      const edgeIntersect = this.getIntersect(position.current, this.edges, false);\n\n      if (edgeIntersect !== false) {\n\n        this.dragIntersect = this.getIntersect(position.current, this.game.cube.cubes, true);\n\n      }\n\n      if (edgeIntersect !== false && this.dragIntersect !== false) {\n\n        this.dragNormal = edgeIntersect.face.normal.round();\n        this.flipType = 'layer';\n\n        this.attach(this.helper, this.edges)\n\n        this.helper.rotation.set(0, 0, 0);\n        this.helper.position.set(0, 0, 0);\n        this.helper.lookAt(this.dragNormal);\n        this.helper.translateZ(0.5);\n        this.helper.updateMatrixWorld();\n\n        this.detach(this.helper, this.edges);\n\n      } else {\n\n        this.dragNormal = new THREE.Vector3(0, 0, 1);\n        this.flipType = 'cube';\n\n        this.helper.position.set(0, 0, 0);\n        this.helper.rotation.set(0, Math.PI / 4, 0);\n        this.helper.updateMatrixWorld();\n\n      }\n\n      let planeIntersect = this.getIntersect(position.current, this.helper, false);\n      if (planeIntersect === false) return;\n\n      this.dragCurrent = this.helper.worldToLocal(planeIntersect.point);\n      this.dragTotal = new THREE.Vector3();\n      this.state = (this.state === STILL) ? PREPARING : this.state;\n\n    };\n\n    this.draggable.onDragMove = position => {\n\n      if (this.scramble !== null) return;\n      if (this.state === STILL || (this.state === ANIMATING && this.gettingDrag === false)) return;\n\n      const planeIntersect = this.getIntersect(position.current, this.helper, false);\n      if (planeIntersect === false) return;\n\n      const point = this.helper.worldToLocal(planeIntersect.point.clone());\n\n      this.dragDelta = point.clone().sub(this.dragCurrent).setZ(0);\n      this.dragTotal.add(this.dragDelta);\n      this.dragCurrent = point;\n      this.addMomentumPoint(this.dragDelta);\n\n      if (this.state === PREPARING && this.dragTotal.length() > 0.05) {\n\n        this.dragDirection = this.getMainAxis(this.dragTotal);\n\n        if (this.flipType === 'layer') {\n\n          const direction = new THREE.Vector3();\n          direction[this.dragDirection] = 1;\n\n          const worldDirection = this.helper.localToWorld(direction).sub(this.helper.position);\n          const objectDirection = this.edges.worldToLocal(worldDirection).round();\n\n          this.flipAxis = objectDirection.cross(this.dragNormal).negate();\n\n          this.selectLayer(this.getLayer(false));\n\n        } else {\n\n          const axis = (this.dragDirection != 'x')\n            ? ((this.dragDirection == 'y' && position.current.x > this.game.world.width / 2) ? 'z' : 'x')\n            : 'y';\n\n          this.flipAxis = new THREE.Vector3();\n          this.flipAxis[axis] = 1 * ((axis == 'x') ? - 1 : 1);\n\n        }\n\n        this.flipAngle = 0;\n        this.state = ROTATING;\n\n      } else if (this.state === ROTATING) {\n\n        const rotation = this.dragDelta[this.dragDirection];\n\n        if (this.flipType === 'layer') {\n\n          this.group.rotateOnAxis(this.flipAxis, rotation);\n          this.flipAngle += rotation;\n\n        } else {\n\n          this.edges.rotateOnWorldAxis(this.flipAxis, rotation);\n          this.game.cube.object.rotation.copy(this.edges.rotation);\n          this.flipAngle += rotation;\n\n        }\n\n      }\n\n    };\n\n    this.draggable.onDragEnd = position => {\n\n      if (this.scramble !== null) return;\n      if (this.state !== ROTATING) {\n\n        this.gettingDrag = false;\n        this.state = STILL;\n        return;\n\n      }\n\n      this.state = ANIMATING;\n\n      const momentum = this.getMomentum()[this.dragDirection];\n      const flip = (Math.abs(momentum) > 0.05 && Math.abs(this.flipAngle) < Math.PI / 2);\n\n      const angle = flip\n        ? this.roundAngle(this.flipAngle + Math.sign(this.flipAngle) * (Math.PI / 4))\n        : this.roundAngle(this.flipAngle);\n\n      const delta = angle - this.flipAngle;\n\n      if (this.flipType === 'layer') {\n\n        this.rotateLayer(delta, false, layer => {\n\n          this.game.storage.saveGame();\n\n          this.state = this.gettingDrag ? PREPARING : STILL;\n          this.gettingDrag = false;\n\n          this.checkIsSolved();\n\n        });\n\n      } else {\n\n        this.rotateCube(delta, () => {\n\n          this.state = this.gettingDrag ? PREPARING : STILL;\n          this.gettingDrag = false;\n\n        });\n\n      }\n\n    };\n\n  }\n\n  rotateLayer(rotation, scramble, callback) {\n\n    const config = scramble ? 0 : this.flipConfig;\n\n    const easing = this.flipEasings[config];\n    const duration = this.flipSpeeds[config]\n    const bounce = (config == 2) ? this.bounceCube() : (() => { });\n\n    this.rotationTween = new Tween({\n      easing: easing,\n      duration: duration,\n      onUpdate: tween => {\n\n        let deltaAngle = tween.delta * rotation;\n        this.group.rotateOnAxis(this.flipAxis, deltaAngle);\n        bounce(tween.value, deltaAngle, rotation);\n\n      },\n      onComplete: () => {\n\n        if (!scramble) this.onMove();\n\n        const layer = this.flipLayer.slice(0);\n\n        this.game.cube.object.rotation.setFromVector3(this.snapRotation(this.game.cube.object.rotation.toVector3()));\n        this.group.rotation.setFromVector3(this.snapRotation(this.group.rotation.toVector3()));\n        this.deselectLayer(this.flipLayer);\n\n        callback(layer);\n\n      },\n    });\n\n  }\n\n  bounceCube() {\n\n    let fixDelta = true;\n\n    return (progress, delta, rotation) => {\n\n      if (progress >= 1) {\n\n        if (fixDelta) {\n\n          delta = (progress - 1) * rotation;\n          fixDelta = false;\n\n        }\n\n        this.game.cube.object.rotateOnAxis(this.flipAxis, delta);\n\n      }\n\n    }\n\n  }\n\n  rotateCube(rotation, callback) {\n\n    const config = this.flipConfig;\n    const easing = [Easing.Power.Out(4), Easing.Sine.Out(), Easing.Back.Out(2)][config];\n    const duration = [100, 150, 350][config]\n\n    this.rotationTween = new Tween({\n      easing: easing,\n      duration: duration,\n      onUpdate: tween => {\n\n        this.edges.rotateOnWorldAxis(this.flipAxis, tween.delta * rotation);\n        this.game.cube.object.rotation.copy(this.edges.rotation);\n\n      },\n      onComplete: () => {\n\n        this.edges.rotation.setFromVector3(this.snapRotation(this.edges.rotation.toVector3()));\n        this.game.cube.object.rotation.copy(this.edges.rotation);\n        callback();\n\n      },\n    });\n\n  }\n\n  selectLayer(layer) {\n\n    this.group.rotation.set(0, 0, 0);\n    this.movePieces(layer, this.game.cube.object, this.group);\n    this.flipLayer = layer;\n\n  }\n\n  deselectLayer(layer) {\n\n    this.movePieces(layer, this.group, this.game.cube.object);\n    this.flipLayer = null;\n\n  }\n\n  movePieces(layer, from, to) {\n\n    from.updateMatrixWorld();\n    to.updateMatrixWorld();\n\n    layer.forEach(index => {\n\n      const piece = this.game.cube.pieces[index];\n\n      piece.applyMatrix(from.matrixWorld);\n      from.remove(piece);\n      piece.applyMatrix(new THREE.Matrix4().getInverse(to.matrixWorld));\n      to.add(piece);\n\n    });\n\n  }\n\n  getLayer(position) {\n\n    const scalar = { 2: 6, 3: 3, 4: 4, 5: 3 }[this.game.cube.size];\n    const layer = [];\n\n    let axis;\n\n    if (position === false) {\n\n      const piece = this.dragIntersect.object.parent;\n\n      axis = this.getMainAxis(this.flipAxis);\n      position = piece.position.clone().multiplyScalar(scalar).round();\n\n    } else {\n\n      axis = this.getMainAxis(position);\n\n    }\n\n    this.game.cube.pieces.forEach(piece => {\n\n      const piecePosition = piece.position.clone().multiplyScalar(scalar).round();\n\n      if (piecePosition[axis] == position[axis]) layer.push(piece.name);\n\n    });\n\n    return layer;\n\n  }\n\n  keyboardMove(type, move, callback) {\n\n    if (this.state !== STILL) return;\n    if (this.enabled !== true) return;\n\n    if (type === 'LAYER') {\n\n      const layer = this.getLayer(move.position);\n\n      this.flipAxis = new THREE.Vector3();\n      this.flipAxis[move.axis] = 1;\n      this.state = ROTATING;\n\n      this.selectLayer(layer);\n      this.rotateLayer(move.angle, false, layer => {\n\n        this.game.storage.saveGame();\n        this.state = STILL;\n        this.checkIsSolved();\n\n      });\n\n    } else if (type === 'CUBE') {\n\n      this.flipAxis = new THREE.Vector3();\n      this.flipAxis[move.axis] = 1;\n      this.state = ROTATING;\n\n      this.rotateCube(move.angle, () => {\n\n        this.state = STILL;\n\n      });\n\n    }\n\n  }\n\n  scrambleCube() {\n\n    if (this.scramble == null) {\n\n      this.scramble = this.game.scrambler;\n      this.scramble.callback = (typeof callback !== 'function') ? () => { } : callback;\n\n    }\n\n    const converted = this.scramble.converted;\n    const move = converted[0];\n    const layer = this.getLayer(move.position);\n\n    this.flipAxis = new THREE.Vector3();\n    this.flipAxis[move.axis] = 1;\n\n    this.selectLayer(layer);\n    this.rotateLayer(move.angle, true, () => {\n\n      converted.shift();\n\n      if (converted.length > 0) {\n\n        this.scrambleCube();\n\n      } else {\n\n        this.scramble = null;\n        this.game.storage.saveGame();\n\n      }\n\n    });\n\n  }\n\n  getIntersect(position, object, multiple) {\n\n    this.raycaster.setFromCamera(\n      this.draggable.convertPosition(position.clone()),\n      this.game.world.camera\n    );\n\n    const intersect = (multiple)\n      ? this.raycaster.intersectObjects(object)\n      : this.raycaster.intersectObject(object);\n\n    return (intersect.length > 0) ? intersect[0] : false;\n\n  }\n\n  getMainAxis(vector) {\n\n    return Object.keys(vector).reduce(\n      (a, b) => Math.abs(vector[a]) > Math.abs(vector[b]) ? a : b\n    );\n\n  }\n\n  detach(child, parent) {\n\n    child.applyMatrix(parent.matrixWorld);\n    parent.remove(child);\n    this.game.world.scene.add(child);\n\n  }\n\n  attach(child, parent) {\n\n    child.applyMatrix(new THREE.Matrix4().getInverse(parent.matrixWorld));\n    this.game.world.scene.remove(child);\n    parent.add(child);\n\n  }\n\n  addMomentumPoint(delta) {\n\n    const time = Date.now();\n\n    this.momentum = this.momentum.filter(moment => time - moment.time < 500);\n\n    if (delta !== false) this.momentum.push({ delta, time });\n\n  }\n\n  getMomentum() {\n\n    const points = this.momentum.length;\n    const momentum = new THREE.Vector2();\n\n    this.addMomentumPoint(false);\n\n    this.momentum.forEach((point, index) => {\n\n      momentum.add(point.delta.multiplyScalar(index / points))\n\n    });\n\n    return momentum;\n\n  }\n\n  roundAngle(angle) {\n\n    const round = Math.PI / 2;\n    return Math.sign(angle) * Math.round(Math.abs(angle) / round) * round;\n\n  }\n\n  snapRotation(angle) {\n\n    return angle.set(\n      this.roundAngle(angle.x),\n      this.roundAngle(angle.y),\n      this.roundAngle(angle.z)\n    );\n\n  }\n\n  checkIsSolved() {\n\n    const start = performance.now();\n\n    let solved = true;\n    const sides = { 'x-': [], 'x+': [], 'y-': [], 'y+': [], 'z-': [], 'z+': [] };\n\n    const positions = [];\n\n    this.game.cube.edges.forEach(edge => {\n\n      const position = edge.parent\n        .localToWorld(edge.position.clone())\n        .sub(this.game.cube.object.position);\n\n      const mainAxis = this.getMainAxis(position);\n      const mainSign = position.multiplyScalar(2).round()[mainAxis] < 1 ? '-' : '+';\n\n      sides[mainAxis + mainSign].push(edge.name);\n\n    });\n\n    Object.keys(sides).forEach(side => {\n\n      if (!sides[side].every(value => value === sides[side][0])) solved = false;\n\n    });\n\n    if (solved) this.onSolved();\n\n  }\n\n}\n\nexport { Controls };\n","class Scrambler {\n\n\tconstructor( game ) {\n\n\t\tthis.game = game;\n\n\t\tthis.dificulty = 0;\n\n\t\tthis.scrambleLength = { //打乱长度2,3,4,5阶\n\t\t\t2: [ 7, 9, 11 ],\n\t\t\t3: [ 20, 25, 30 ],\n\t\t\t4: [ 30, 40, 50 ],\n\t\t\t5: [ 40, 60, 80 ],\n\t\t};\n\n\t\tthis.moves = [];\n\t\tthis.conveted = [];\n\t\tthis.pring = '';\n\n\t}\n\n\tscramble( scramble ) {\n\n\t\tlet count = 0;\n\t\tthis.moves = ( typeof scramble !== 'undefined' ) ? scramble.split( ' ' ) : [];\n\n\t\tif ( this.moves.length < 1 ) {\n\n\t\t\tconst scrambleLength = this.scrambleLength[ this.game.cube.size ][ this.dificulty ];\n\n\t\t\tconst faces = this.game.cube.size < 4 ? 'UDLRFB' : 'UuDdLlRrFfBb';\n\t\t\tconst modifiers = [ \"\", \"'\", \"2\" ];\n\t\t\tconst total = ( typeof scramble === 'undefined' ) ? scrambleLength : scramble;\n\n\t\t\twhile ( count < total ) {\n\n\t\t\t\tconst move =\n\t\t\t\t\tfaces[ Math.floor( Math.random() * faces.length ) ] +\n\t\t\t\t\tmodifiers[ Math.floor( Math.random() * 3 ) ];\n\n\t\t\t\tif ( count > 0 && move.charAt( 0 ) == this.moves[ count - 1 ].charAt( 0 ) ) continue;\n\t\t\t\tif ( count > 1 && move.charAt( 0 ) == this.moves[ count - 2 ].charAt( 0 ) ) continue;\n\n\t\t\t\tthis.moves.push( move );\n\t\t\t\tcount ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.callback = () => {};\n\t\tthis.convert();\n\t\tthis.print = this.moves.join( ' ' );\n\n\t\treturn this;\n\n\t}\n\n\tconvert( moves ) {\n\n\t\tthis.converted = [];\n\n\t\tthis.moves.forEach( move => {\n\n\t\t\tconst convertedMove = this.convertMove( move );\n\t\t\tconst modifier = move.charAt( 1 );\n\n\t\t\tthis.converted.push( convertedMove );\n\t\t\tif ( modifier == \"2\" ) this.converted.push( convertedMove );\n\n\t\t} );\n\n\t}\n\n\tconvertMove( move ) {\n\n\t\tconst face = move.charAt( 0 );\n\t\tconst modifier = move.charAt( 1 );\n\n\t\tconst axis = { D: 'y', U: 'y', L: 'x', R: 'x', F: 'z', B: 'z' }[ face.toUpperCase() ];\n\t\tlet row = { D: -1, U: 1, L: -1, R: 1, F: 1, B: -1 }[ face.toUpperCase() ];\n\n\t\tif ( this.game.cube.size > 3 && face !== face.toLowerCase() ) row = row * 2;\n\n\t\tconst position = new THREE.Vector3();\n\t\tposition[ { D: 'y', U: 'y', L: 'x', R: 'x', F: 'z', B: 'z' }[ face.toUpperCase() ] ] = row;\n\n\t\tconst angle = ( Math.PI / 2 ) * - row * ( ( modifier == \"'\" ) ? - 1 : 1 );\n\n\t\treturn { position, axis, angle, name: move };\n\n\t}\n\n}\n\nexport { Scrambler };","import { Tween, Easing } from './utils/Tween.js';\n\nclass Transition { //过渡动画\n\n  constructor( game ) {\n\n    this.game = game;\n\n    this.tweens = {};\n    this.durations = {};\n    this.data = {\n      cubeY: -0.2,\n      cameraZoom: 0.85,\n    };\n\n    this.activeTransitions = 0;\n\n  }\n\n  init() {\n\n    this.game.controls.disable();\n\n    this.game.cube.object.position.y = this.data.cubeY;\n    this.game.cube.animator.position.y = 4;\n    this.game.cube.animator.rotation.x = - Math.PI / 3;\n    this.game.world.camera.zoom = this.data.cameraZoom;\n    this.game.world.camera.updateProjectionMatrix();\n\n    this.tweens.buttons = {};\n    this.tweens.timer = [];\n    this.tweens.title = [];\n    this.tweens.best = [];\n    this.tweens.complete = [];\n    this.tweens.prefs = [];\n    this.tweens.theme = [];\n    this.tweens.stats = [];\n\n  }\n\n  buttons( show, hide ) {\n\n    const buttonTween = ( button, show ) => {\n\n      return new Tween( {\n        target: button.style,\n        duration: 100,\n        easing: show ? Easing.Power.Out( 2 ) : Easing.Power.In( 3 ),\n        from: { opacity: show ? 0 : 1 },\n        to: { opacity: show ? 1 : 0 },\n        onUpdate: tween => {\n\n          const translate = show ? 1 - tween.value : tween.value;\n          button.style.transform = `translate3d(0, ${translate * 1.5}em, 0)`;\n\n        },\n        onComplete: () => button.style.pointerEvents = show ? 'all' : 'none'\n      } );\n\n    }\n\n    hide.forEach( button =>\n      this.tweens.buttons[ button ] = buttonTween( this.game.dom.buttons[ button ], false )\n    );\n\n    setTimeout( () => show.forEach( button => {\n\n      this.tweens.buttons[ button ] = buttonTween( this.game.dom.buttons[ button ], true )\n\n    } ), hide ? 500 : 0 );\n\n  }\n\n  cube( show, theming = false ) {\n\n    this.activeTransitions++;\n\n    try { this.tweens.cube.stop() } catch(e) {};\n\n    const currentY = this.game.cube.animator.position.y;\n    const currentRotation = this.game.cube.animator.rotation.x;\n\n    this.tweens.cube = new Tween( {\n      duration: show ? 1500 : 500,\n      easing: show ? Easing.Elastic.Out( 0.8, 0.6 ) : Easing.Back.In( 1 ),\n      onUpdate: tween => {\n\n        this.game.cube.animator.position.y = show\n          ? ( theming ? 0.9 + ( 1 - tween.value ) * 3.5 : ( 1 - tween.value ) * 4 )\n          : currentY + tween.value * 4;\n\n        this.game.cube.animator.rotation.x = show\n          ? ( 1 - tween.value ) * Math.PI / 3\n          : currentRotation + tween.value * - Math.PI / 3;\n\n      },\n    } );\n\n    if ( theming ) {\n\n      if ( show ) {\n\n        this.game.world.camera.zoom = 0.75;\n        this.game.world.camera.updateProjectionMatrix();\n\n      } else {\n\n        setTimeout( () => {\n\n          this.game.world.camera.zoom = this.data.cameraZoom;\n          this.game.world.camera.updateProjectionMatrix();\n\n        }, 1500 );\n\n      }\n\n    }\n\n    this.durations.cube = show ? 1500 : 1500;\n\n    setTimeout( () => this.activeTransitions--, this.durations.cube );\n\n  }\n\n  float() {\n\n    try { this.tweens.float.stop() } catch(e) {};\n\n    this.tweens.float = new Tween( {\n      duration: 1500,\n      easing: Easing.Sine.InOut(),\n      yoyo: true,\n      onUpdate: tween => {\n\n        this.game.cube.holder.position.y = (- 0.02 + tween.value * 0.04); \n        this.game.cube.holder.rotation.x = 0.005 - tween.value * 0.01;\n        this.game.cube.holder.rotation.z = - this.game.cube.holder.rotation.x;\n        this.game.cube.holder.rotation.y = this.game.cube.holder.rotation.x;\n\n        this.game.controls.edges.position.y =\n          this.game.cube.holder.position.y + this.game.cube.object.position.y;\n\n      },\n    } );\n\n  }\n\n  zoom( play, time ) {\n\n    this.activeTransitions++;\n\n    const zoom = ( play ) ? 1 : this.data.cameraZoom;\n    const duration = ( time > 0 ) ? Math.max( time, 1500 ) : 1500;\n    const rotations = ( time > 0 ) ? Math.round( duration / 1500 ) : 1;\n    const easing = Easing.Power.InOut( ( time > 0 ) ? 2 : 3 );\n\n    this.tweens.zoom = new Tween( {\n      target: this.game.world.camera,\n      duration: duration,\n      easing: easing,\n      to: { zoom: zoom },\n      onUpdate: () => { this.game.world.camera.updateProjectionMatrix(); },\n    } );\n\n    this.tweens.rotate = new Tween( {\n      target: this.game.cube.animator.rotation,\n      duration: duration,\n      easing: easing,\n      to: { y: - Math.PI * 2 * rotations },\n      onComplete: () => { this.game.cube.animator.rotation.y = 0; },\n    } );\n\n    this.durations.zoom = duration;\n\n    setTimeout( () => this.activeTransitions--, this.durations.zoom );\n\n  }\n\n  elevate( complete ) {\n\n    this.activeTransitions++;\n\n    const cubeY = \n\n    this.tweens.elevate = new Tween( {\n      target: this.game.cube.object.position,\n      duration: complete ? 1500 : 0,\n      easing: Easing.Power.InOut( 3 ),\n      to: { y: complete ? -0.05 : this.data.cubeY }\n    } );\n\n    this.durations.elevate = 1500;\n\n    setTimeout( () => this.activeTransitions--, this.durations.elevate );\n\n  }\n\n  complete( show, best ) {\n\n    this.activeTransitions++;\n\n    const text = best ? this.game.dom.texts.best : this.game.dom.texts.complete;\n\n    if ( text.querySelector( 'span i' ) === null )\n      text.querySelectorAll( 'span' ).forEach( span => this.splitLetters( span ) );\n\n    const letters = text.querySelectorAll( '.icon, i' );\n\n    this.flipLetters( best ? 'best' : 'complete', letters, show );\n\n    text.style.opacity = 1;\n\n    const duration = this.durations[ best ? 'best' : 'complete' ];\n\n    if ( ! show ) setTimeout( () => this.game.dom.texts.timer.style.transform = '', duration );\n\n    setTimeout( () => this.activeTransitions--, duration );\n\n  } \n\n  stats( show ) {\n\n    if ( show ) this.game.scores.calcStats();\n\n    this.activeTransitions++;\n\n    this.tweens.stats.forEach( tween => { tween.stop(); tween = null; } );\n\n    let tweenId = -1;\n\n    const stats = this.game.dom.stats.querySelectorAll( '.stats' );\n    const easing = show ? Easing.Power.Out( 2 ) : Easing.Power.In( 3 );\n\n    stats.forEach( ( stat, index ) => {\n\n      const delay = index * ( show ? 80 : 60 );\n\n      this.tweens.stats[ tweenId++ ] = new Tween( {\n        delay: delay,\n        duration: 200,\n        easing: easing,\n        onUpdate: tween => {\n\n          const translate = show ? ( 1 - tween.value ) * 2 : tween.value;\n          const opacity = show ? tween.value : ( 1 - tween.value );\n\n          stat.style.transform = `translate3d(0, ${translate}em, 0)`;\n          stat.style.opacity = opacity;\n\n        }\n      } );\n\n    } );\n\n    this.durations.stats = 0;\n\n    setTimeout( () => this.activeTransitions--, this.durations.stats );\n\n  }\n\n  preferences( show ) {\n\n    this.ranges( this.game.dom.prefs.querySelectorAll( '.range' ), 'prefs', show );\n\n  }\n\n  theming( show ) {\n\n    this.ranges( this.game.dom.theme.querySelectorAll( '.range' ), 'prefs', show );\n\n  }\n\n  ranges( ranges, type, show ) {\n\n    this.activeTransitions++;\n\n    this.tweens[ type ].forEach( tween => { tween.stop(); tween = null; } );\n\n    const easing = show ? Easing.Power.Out(2) : Easing.Power.In(3);\n\n    let tweenId = -1;\n    let listMax = 0;\n\n    ranges.forEach( ( range, rangeIndex ) => {\n    \n      const label = range.querySelector( '.range__label' );\n      const track = range.querySelector( '.range__track-line' );\n      const handle = range.querySelector( '.range__handle' );\n      const list = range.querySelectorAll( '.range__list div' );\n\n      const delay = rangeIndex * ( show ? 0 : 100 );\n\n      label.style.opacity = show ? 0 : 1;\n      track.style.opacity = show ? 0 : 1;\n      handle.style.opacity = show ? 0 : 1;\n      handle.style.pointerEvents = show ? 'all' : 'none';\n\n      this.tweens[ type ][ tweenId++ ] = new Tween( {\n        delay: show ? delay : delay,\n        duration: 400,\n        easing: easing,\n        onUpdate: tween => {\n\n          const translate = show ? ( 1 - tween.value ) : tween.value;\n          const opacity = show ? tween.value : ( 1 - tween.value );\n\n          label.style.transform = `translate3d(0, ${translate}em, 0)`;\n          label.style.opacity = opacity;\n\n        }\n      } );\n\n      this.tweens[ type ][ tweenId++ ] = new Tween( {\n        delay: show ? delay + 100 : delay,\n        duration: 400,\n        easing: easing,\n        onUpdate: tween => {\n\n          const translate = show ? ( 1 - tween.value ) : tween.value;\n          const scale = show ? tween.value : ( 1 - tween.value );\n          const opacity = scale;\n\n          track.style.transform = `translate3d(0, ${translate}em, 0) scale3d(${scale}, 1, 1)`;\n          track.style.opacity = opacity;\n\n        }\n      } );\n\n      this.tweens[ type ][ tweenId++ ] = new Tween( {\n        delay: show ? delay + 100 : delay,\n        duration: 400,\n        easing: easing,\n        onUpdate: tween => {\n\n          const translate = show ? ( 1 - tween.value ) : tween.value;\n          const opacity = 1 - translate;\n          const scale = 0.5 + opacity * 0.5;\n\n          handle.style.transform = `translate3d(0, ${translate}em, 0) scale3d(${scale}, ${scale}, ${scale})`;\n          handle.style.opacity = opacity;\n\n        }\n      } );\n\n      list.forEach( ( listItem, labelIndex ) => {\n\n        listItem.style.opacity = show ? 0 : 1;\n\n        this.tweens[ type ][ tweenId++ ] = new Tween( {\n          delay: show ? delay + 200 + labelIndex * 50 : delay,\n          duration: 400,\n          easing: easing,\n          onUpdate: tween => {\n\n            const translate = show ? ( 1 - tween.value ) : tween.value;\n            const opacity = show ? tween.value : ( 1 - tween.value );\n\n            listItem.style.transform = `translate3d(0, ${translate}em, 0)`;\n            listItem.style.opacity = opacity;\n\n          }\n        } );\n\n      } );\n\n      listMax = list.length > listMax ? list.length - 1 : listMax;\n\n      range.style.opacity = 1;\n\n    } );\n\n    this.durations[ type ] = show\n      ? ( ( ranges.length - 1 ) * 100 ) + 200 + listMax * 50 + 400\n      : ( ( ranges.length - 1 ) * 100 ) + 400;\n\n    setTimeout( () => this.activeTransitions--, this.durations[ type ] ); \n\n  }\n\n  title( show ) {\n\n    this.activeTransitions++;\n\n    const title = this.game.dom.texts.title;\n\n    if ( title.querySelector( 'span i' ) === null )\n      title.querySelectorAll( 'span' ).forEach( span => this.splitLetters( span ) );\n\n    const letters = title.querySelectorAll( 'i' );\n\n    this.flipLetters( 'title', letters, show );\n\n    title.style.opacity = 1;\n\n    const note = this.game.dom.texts.note;\n\n    this.tweens.title[ letters.length ] = new Tween( {\n      target: note.style,\n      easing: Easing.Sine.InOut(),\n      duration: show ? 800 : 400,\n      yoyo: show ? true : null,\n      from: { opacity: show ? 0 : ( parseFloat( getComputedStyle( note ).opacity ) ) },\n      to: { opacity: show ? 1 : 0 },\n    } );\n\n    setTimeout( () => this.activeTransitions--, this.durations.title );\n\n  }\n\n  timer( show ) {\n\n    this.activeTransitions++;\n\n    const timer = this.game.dom.texts.timer;\n\n    timer.style.opacity = 0;\n    this.game.timer.convert();\n    this.game.timer.setText();\n\n    this.splitLetters( timer );\n    const letters = timer.querySelectorAll( 'i' );\n    this.flipLetters( 'timer', letters, show );\n\n    timer.style.opacity = 1;\n\n    setTimeout( () => this.activeTransitions--, this.durations.timer );\n\n  }\n\n  splitLetters( element ) {\n\n    const text = element.innerHTML;\n\n    element.innerHTML = '';\n\n    text.split( '' ).forEach( letter => {\n\n      const i = document.createElement( 'i' );\n\n      i.innerHTML = letter;\n\n      element.appendChild( i );\n\n    } );\n\n  }\n\n  flipLetters( type, letters, show ) {\n\n    try { this.tweens[ type ].forEach( tween => tween.stop() ) } catch(e) {};\n\n    letters.forEach( ( letter, index ) => {\n\n      letter.style.opacity = show ? 0 : 1;\n\n      this.tweens[ type ][ index ] = new Tween( {\n        easing: Easing.Sine.Out(),\n        duration: show ? 800 : 400,\n        delay: index * 50,\n        onUpdate: tween => {\n\n          const rotation = show ? ( 1 - tween.value ) * -80 : tween.value * 80;\n\n          letter.style.transform = `rotate3d(0, 1, 0, ${rotation}deg)`;\n          letter.style.opacity = show ? tween.value : ( 1 - tween.value );\n\n        },\n      } );\n\n    } );\n\n    this.durations[ type ] = ( letters.length - 1 ) * 50 + ( show ? 800 : 400 );\n\n  }\n\n}\n\nexport { Transition };\n","import { Animation } from './utils/Animation.js';\n\nclass Timer extends Animation {\n\n\tconstructor( game ) {\n\n\t\tsuper( false );\n\n\t\tthis.game = game;\n\t\tthis.reset();\n\t\t\n\t}\n\n\tstart( continueGame ) {\n\n\t\tthis.startTime = continueGame ? ( Date.now() - this.deltaTime ) : Date.now();\n\t\tthis.deltaTime = 0;\n\t\tthis.converted = this.convert();\n\n\t\tsuper.start();\n\n\t}\n\n\treset() {\n\n\t\tthis.startTime = 0;\n\t\tthis.currentTime = 0;\n\t\tthis.deltaTime = 0;\n\t\tthis.converted = '0:00';\n\n\t}\n\n\tstop() {\n\n\t\tthis.currentTime = Date.now();\n\t\tthis.deltaTime = this.currentTime - this.startTime;\n\t\tthis.convert();\n\n\t\tsuper.stop();\n\n\t\treturn { time: this.converted, millis: this.deltaTime };\n\n\t}\n\n\tupdate() {\n\n\t\tconst old = this.converted;\n\n\t\tthis.currentTime = Date.now();\n\t\tthis.deltaTime = this.currentTime - this.startTime;\n\t\tthis.convert();\n\n\t\tif ( this.converted != old ) {\n\n\t\t\tlocalStorage.setItem( 'theCube_time', this.deltaTime );\n\t\t\tthis.setText();\n\n\t\t}\n\n\t}\n\n\tconvert() {\n\n\t\tconst seconds = parseInt( ( this.deltaTime / 1000 ) % 60 );\n\t\tconst minutes = parseInt( ( this.deltaTime / ( 1000 * 60 ) ) );\n\n\t\tthis.converted = minutes + ':' + ( seconds < 10 ? '0' : '' ) + seconds;\n\n\t}\n\n\tsetText() {\n\n\t\tthis.game.dom.texts.timer.innerHTML = this.converted;\n\n\t}\n\n}\n\nexport { Timer };\n","import { Draggable } from './utils/Draggable.js';\n\nconst RangeHTML = [\n\n  '<div class=\"range\">',\n    '<div class=\"range__label\"></div>',\n    '<div class=\"range__track\">',\n      '<div class=\"range__track-line\"></div>',\n      '<div class=\"range__handle\"><div></div></div>',\n    '</div>',\n    '<div class=\"range__list\"></div>',\n  '</div>',\n\n].join( '\\n' );\n\ndocument.querySelectorAll( 'range' ).forEach( el => {\n\n  const temp = document.createElement( 'div' );\n  temp.innerHTML = RangeHTML;\n\n  const range = temp.querySelector( '.range' );\n  const rangeLabel = range.querySelector( '.range__label' );\n  const rangeList = range.querySelector( '.range__list' );\n\n  range.setAttribute( 'name', el.getAttribute( 'name' ) );\n  rangeLabel.innerHTML = el.getAttribute( 'title' );\n\n  if ( el.hasAttribute( 'color' ) ) {\n\n    range.classList.add( 'range--type-color' );\n    range.classList.add( 'range--color-' + el.getAttribute( 'name' ) );\n\n  }\n\n  if ( el.hasAttribute( 'list' ) ) {\n\n    el.getAttribute( 'list' ).split( ',' ).forEach( listItemText => {\n\n      const listItem = document.createElement( 'div' );\n      listItem.innerHTML = listItemText;\n      rangeList.appendChild( listItem );\n\n    } );\n\n  }\n\n  el.parentNode.replaceChild( range, el );\n\n} );\n\nclass Range {\n\n  constructor( name, options ) {\n\n    options = Object.assign( {\n      range: [ 0, 1 ],\n      value: 0,\n      step: 0,\n      onUpdate: () => {},\n      onComplete: () => {},\n    }, options || {} );\n\n    this.element = document.querySelector( '.range[name=\"' + name + '\"]' );\n    this.track = this.element.querySelector( '.range__track' );\n    this.handle = this.element.querySelector( '.range__handle' );\n    this.list = [].slice.call( this.element.querySelectorAll( '.range__list div' ) );\n\n    this.value = options.value;\n    this.min = options.range[0];\n    this.max = options.range[1];\n    this.step = options.step;\n\n    this.onUpdate = options.onUpdate;\n    this.onComplete = options.onComplete;\n\n    this.setValue( this.value );\n\n    this.initDraggable();\n\n  }\n\n  setValue( value ) {\n\n    this.value = this.round( this.limitValue( value ) );\n    this.setHandlePosition();\n\n  }\n\n  initDraggable() {\n\n    const oldPosition = null;\n\n    let current;\n\n    this.draggable = new Draggable( this.handle, { calcDelta: true } );\n\n    this.draggable.onDragStart = position => {\n\n      current = this.positionFromValue( this.value );\n      this.handle.style.left = current + 'px';\n\n    }\n\n    this.draggable.onDragMove = position => {\n\n      current = this.limitPosition( current + position.delta.x );\n      this.value = this.round( this.valueFromPosition( current ) );\n      this.setHandlePosition();\n      \n      this.onUpdate( this.value );\n\n    }\n\n    this.draggable.onDragEnd = position => {\n\n      this.onComplete( this.value );\n\n    }\n\n  }\n\n  round( value ) {\n\n    if ( this.step < 1 ) return value;\n\n    return Math.round( ( value - this.min ) / this.step ) * this.step + this.min;\n\n  }\n\n  limitValue( value ) {\n\n    const max = Math.max( this.max, this.min );\n    const min = Math.min( this.max, this.min );\n\n    return Math.min( Math.max( value, min ), max );\n\n  }\n\n  limitPosition( position ) {\n\n    return Math.min( Math.max( position, 0 ), this.track.offsetWidth );\n\n  }\n\n  percentsFromValue( value ) {\n\n    return ( value - this.min ) / ( this.max - this.min );\n\n  }\n\n  valueFromPosition( position ) {\n\n    return this.min + ( this.max - this.min ) * ( position / this.track.offsetWidth );\n\n  }\n\n  positionFromValue( value ) {\n\n    return this.percentsFromValue( value ) * this.track.offsetWidth;\n\n  }\n\n  setHandlePosition() {\n\n    this.handle.style.left = this.percentsFromValue( this.value ) * 100 + '%';\n\n  }\n\n}\n\nexport { Range };\n","import { Range } from './Range.js';\n\nclass Preferences {\n\n  constructor( game ) {\n\n    this.game = game;\n\n  }\n\n  init() {\n\n    const getProgressInRange = ( value, start, end ) => {\n\n      return Math.min( Math.max( (value - start) / (end - start), 0 ), 1 );\n      \n    }\n\n    this.ranges = {\n\n      size: new Range( 'size', {\n        value: this.game.cube.size,//阶数\n        range: [ 2, 5 ],//二阶-五阶\n        step: 1,//划一下跳一格\n        onUpdate: value => {\n          this.game.cube.size = value;\n          this.game.preferences.ranges.scramble.list.forEach( ( item, i ) => {\n            item.innerHTML = this.game.scrambler.scrambleLength[ this.game.cube.size ][ i ];\n          } );\n\n        },\n        onComplete: () => this.game.storage.savePreferences(),//保存参数\n      } ),\n\n      flip: new Range( 'flip', {\n        value: this.game.controls.flipConfig,\n        range: [ 0, 2 ],\n        step: 1,\n        onUpdate: value => {\n\n          this.game.controls.flipConfig = value;\n\n        },\n        onComplete: () => this.game.storage.savePreferences(),\n      } ),\n\n      scramble: new Range( 'scramble', {\n        value: this.game.scrambler.dificulty,\n        range: [ 0, 2 ],\n        step: 1,\n        onUpdate: value => {\n\n          this.game.scrambler.dificulty = value;\n\n        },\n        onComplete: () => this.game.storage.savePreferences()\n      } ),\n\n      fov: new Range( 'fov', {\n        value: this.game.world.fov,\n        range: [ 2, 45 ],\n        onUpdate: value => {\n\n          this.game.world.fov = value;\n          this.game.world.resize();\n\n        },\n        onComplete: () => this.game.storage.savePreferences()\n      } ),\n\n      theme: new Range( 'theme', {\n        value: { cube: 0, erno: 1, dust: 2, camo: 3, rain: 4 }[ this.game.themes.theme ],\n        range: [ 0, 4 ],\n        step: 1,\n        onUpdate: value => {\n\n          const theme = [ 'cube', 'erno', 'dust', 'camo', 'rain' ][ value ]\n          this.game.themes.setTheme( theme );\n\n        },\n        onComplete: () => this.game.storage.savePreferences()\n      } ),\n\n      hue: new Range( 'hue', {\n        value: 0,\n        range: [ 0, 360 ],\n        onUpdate: value => this.game.themeEditor.updateHSL(),\n        onComplete: () => this.game.storage.savePreferences(),\n      } ),\n\n      saturation: new Range( 'saturation', {\n        value: 100,\n        range: [ 0, 100 ],\n        onUpdate: value => this.game.themeEditor.updateHSL(),\n        onComplete: () => this.game.storage.savePreferences(),\n      } ),\n\n      lightness: new Range( 'lightness', {\n        value: 50,\n        range: [ 0, 100 ],\n        onUpdate: value => this.game.themeEditor.updateHSL(),\n        onComplete: () => this.game.storage.savePreferences(),\n      } ),\n\n    };\n\n    this.ranges.scramble.list.forEach( ( item, i ) => {\n\n      item.innerHTML = this.game.scrambler.scrambleLength[ this.game.cube.size ][ i ];\n\n    } );\n    \n  }\n\n}\n\nexport { Preferences };\n","import { Animation } from './utils/Animation.js';\n\nclass Confetti { //撒花\n\n  constructor( game ) {\n\n    this.game = game;\n    this.started = 0;\n\n    this.options = {\n      speed: { min: 0.0011, max: 0.0022 },\n      revolution: { min: 0.01, max: 0.05 },\n      size: { min: 0.1, max: 0.15 },\n      colors: [ 0x41aac8, 0x82ca38, 0xffef48, 0xef3923, 0xff8c0a ],\n    }\n\n    this.geometry = new THREE.PlaneGeometry( 1, 1 );\n    this.material = new THREE.MeshBasicMaterial( { side: THREE.DoubleSide } );\n\n    this.holders = [\n      new ConfettiStage( this.game, this, 1, 20 ),\n      new ConfettiStage( this.game, this, -1, 30 ),\n    ];\n\n  }\n\n  start() {\n\n    if ( this.started > 0 ) return;\n\n    this.holders.forEach( holder => {\n\n      this.game.world.scene.add( holder.holder );\n      holder.start();\n      this.started ++;\n\n    } );\n\n  }\n\n  stop() {\n\n    if ( this.started == 0 ) return;\n\n    this.holders.forEach( holder => {\n\n      holder.stop( () => {\n\n        this.game.world.scene.remove( holder.holder );\n        this.started --;\n\n      } );\n\n    } );\n\n  }\n\n  updateColors( colors ) {\n\n    this.holders.forEach( holder => {\n\n      holder.options.colors.forEach( ( color, index ) => {\n\n        holder.options.colors[ index ] = colors[ [ 'D', 'F', 'R', 'B', 'L' ][ index ] ];\n\n      } );\n\n    } );\n\n  }\n\n}\n\nclass ConfettiStage extends Animation {\n\n  constructor( game, parent, distance, count ) {\n\n    super( false );\n\n    this.game = game;\n    this.parent = parent;\n\n    this.distanceFromCube = distance;\n\n    this.count = count;\n    this.particles = [];\n\n    this.holder = new THREE.Object3D();\n    this.holder.rotation.copy( this.game.world.camera.rotation );\n\n    this.object = new THREE.Object3D();\n    this.holder.add( this.object );\n\n    this.resizeViewport = this.resizeViewport.bind( this );\n    this.game.world.onResize.push( this.resizeViewport )\n    this.resizeViewport();    \n\n    this.geometry = this.parent.geometry;\n    this.material = this.parent.material;\n\n    this.options = this.parent.options;\n\n    let i = this.count;\n    while ( i-- ) this.particles.push( new Particle( this ) );\n\n  }\n\n  start() {\n\n    this.time = performance.now();\n    this.playing = true;\n\n    let i = this.count;\n    while ( i-- ) this.particles[ i ].reset();\n\n    super.start();\n\n  }\n\n  stop( callback ) {\n\n    this.playing = false;\n    this.completed = 0;\n    this.callback = callback;\n\n  }\n\n  reset() {\n\n    super.stop();\n\n    this.callback();\n\n  }\n\n  update() {\n\n    const now = performance.now();\n    const delta = now - this.time;\n    this.time = now;\n\n    let i = this.count;\n\n    while ( i-- )\n      if ( ! this.particles[ i ].completed ) this.particles[ i ].update( delta );\n\n    if ( ! this.playing && this.completed == this.count ) this.reset();\n\n  }\n\n  resizeViewport() {\n\n    const fovRad = this.game.world.camera.fov * THREE.Math.DEG2RAD;\n\n    this.height = 2 * Math.tan( fovRad / 2 ) * ( this.game.world.camera.position.length() - this.distanceFromCube );\n    this.width = this.height * this.game.world.camera.aspect;\n\n    const scale = 1 / this.game.transition.data.cameraZoom;\n\n    this.width *= scale;\n    this.height *= scale;\n\n    this.object.position.z = this.distanceFromCube;\n    this.object.position.y = this.height / 2;\n\n  }\n  \n}\n\nclass Particle { //纸屑\n\n  constructor( confetti ) {\n\n    this.confetti = confetti;\n    this.options = this.confetti.options;\n\n    this.velocity = new THREE.Vector3(); //速度\n    this.force = new THREE.Vector3(); //力\n\n    this.mesh = new THREE.Mesh( this.confetti.geometry, this.confetti.material.clone() );\n    this.confetti.object.add( this.mesh );\n\n    this.size = THREE.Math.randFloat( this.options.size.min, this.options.size.max );\n    this.mesh.scale.set( this.size, this.size, this.size );\n\n    return this;\n\n  }\n\n  reset( randomHeight = true ) {\n\n    this.completed = false;\n\n    this.color = new THREE.Color( this.options.colors[ Math.floor( Math.random() * this.options.colors.length ) ] );\n    this.mesh.material.color.set( this.color );\n\n    this.speed = THREE.Math.randFloat( this.options.speed.min, this.options.speed.max ) * - 1;\n    this.mesh.position.x = THREE.Math.randFloat( - this.confetti.width / 2, this.confetti.width / 2 );\n    this.mesh.position.y = ( randomHeight )\n      ? THREE.Math.randFloat( this.size, this.confetti.height + this.size )\n      : this.size;\n\n    this.revolutionSpeed = THREE.Math.randFloat( this.options.revolution.min, this.options.revolution.max );\n    this.revolutionAxis = [ 'x', 'y', 'z' ][ Math.floor( Math.random() * 3 ) ];\n    this.mesh.rotation.set( Math.random() * Math.PI / 3, Math.random() * Math.PI / 3, Math.random() * Math.PI / 3 );\n\n  }\n\n  stop() {\n\n    this.completed = true;\n    this.confetti.completed ++;\n\n  }\n\n  update( delta ) {\n\n    this.mesh.position.y += this.speed * delta;\n    this.mesh.rotation[ this.revolutionAxis ] += this.revolutionSpeed;\n\n    if ( this.mesh.position.y < - this.confetti.height - this.size )\n      ( this.confetti.playing ) ? this.reset( false ) : this.stop();\n\n  }\n\n}\n\nexport { Confetti };\n","class Scores { //分数\n\n  constructor(game) {\n\n    this.game = game;\n\n    this.data = {\n      2: {\n        scores: [], //存时间\n        solves: 0, //完成次数\n        best: 0, //最好成绩\n        worst: 0, //最差成绩\n      },\n      3: {\n        scores: [],\n        solves: 0,\n        best: 0,\n        worst: 0,\n      },\n      4: {\n        scores: [],\n        solves: 0,\n        best: 0,\n        worst: 0,\n      },\n      5: {\n        scores: [],\n        solves: 0,\n        best: 0,\n        worst: 0,\n      }\n    }\n\n  }\n\n  addScore(time) {\n\n    const data = this.data[this.game.cube.sizeGenerated]; //对应阶数的数据\n\n    data.scores.push(time);\n    data.solves++; //完成数加一\n    // shift() 方法用于把数组的第一个元素从其中删除，并返回第一个元素的值\n    if (data.scores.lenght > 100) data.scores.shift();\n\n    let bestTime = false\n\n    if (time < data.best || data.best === 0) {\n      data.best = time;\n      bestTime = true;\n    }\n\n    if (time > data.worst)\n      data.worst = time;\n\n    this.game.storage.saveScores();\n    return bestTime;\n\n  }\n\n  calcStats() { //计算统计\n\n    const s = this.game.cube.sizeGenerated; //阶数\n    const data = this.data[s];\n\n    this.setStat('cube-size', `${s}<i>x</i>${s}<i>x</i>${s}`);\n    this.setStat('total-solves', data.solves);\n    this.setStat('best-time', this.convertTime(data.best));\n    this.setStat('worst-time', this.convertTime(data.worst));\n    this.setStat('average', this.getAverage(data.solves));\n  }\n\n  clearStats(){\n    const s = this.game.cube.sizeGenerated; //阶数\n    const data = this.data[s];\n\n    this.setStat('cube-size', `${s}<i>x</i>${s}<i>x</i>${s}`);\n    this.setStat('total-solves', '-');\n    this.setStat('best-time', '-');\n    this.setStat('worst-time', '-');\n    this.setStat('average', '-');\n  }\n\n  setStat(name, value) {\n\n    if (value === 0) value = '-';\n\n    this.game.dom.stats.querySelector(`.stats[name=\"${name}\"] b`).innerHTML = value;\n\n  }\n\n  getAverage(count) {\n\n    const data = this.data[this.game.cube.sizeGenerated];\n\n    if (data.scores.length < count) return 0;\n\n    return this.convertTime(data.scores.slice(-count).reduce((a, b) => a + b, 0) / count);\n\n  }\n  // 时间转换\n  convertTime(time) {\n\n    if (time <= 0) return 0;\n\n    const seconds = parseInt((time / 1000) % 60);\n    const minutes = parseInt((time / (1000 * 60)));\n\n    return minutes + ':' + (seconds < 10 ? '0' : '') + seconds;\n\n  }\n\n}\n\nexport { Scores };\n","class Storage { //本地存储方案 localstorage\n\n  constructor( game ) {\n\n    this.game = game;\n    const userVersion = localStorage.getItem( 'theCube_version' ); // 获取指定key本地存储的值\n    if ( ! userVersion || userVersion !== window.gameVersion ) {\n      this.clearGame();\n      this.clearPreferences();\n      this.migrateScores();\n      localStorage.setItem( 'theCube_version', window.gameVersion ); //将value存储到key字段 后->前\n    }\n  }\n\n  init() {\n    this.loadPreferences(); //参数\n    this.loadScores(); //分数\n  }\n\n  loadGame() { //加载本地的游戏数据\n    try {\n      const gameInProgress = localStorage.getItem( 'theCube_playing' ) === 'true';\n\n      if ( ! gameInProgress ) throw new Error();\n\n      const gameCubeData = JSON.parse( localStorage.getItem( 'theCube_savedState' ) ); //魔方状态\n      const gameTime = parseInt( localStorage.getItem( 'theCube_time' ) ); //时间\n\n      if ( ! gameCubeData || gameTime === null ) throw new Error();\n      if ( gameCubeData.size !== this.game.cube.sizeGenerated ) throw new Error();\n\n      this.game.cube.loadFromData( gameCubeData );\n\n      this.game.timer.deltaTime = gameTime;\n\n      this.game.saved = true;\n\n    } catch( e ) {\n\n      this.game.saved = false;\n\n    }\n\n  }\n\n  saveGame() { //存储游戏数据\n\n    const gameInProgress = true;\n    const gameCubeData = { names: [], positions: [], rotations: [] };\n    const gameTime = this.game.timer.deltaTime;\n\n    gameCubeData.size = this.game.cube.sizeGenerated;\n\n    this.game.cube.pieces.forEach( piece => {\n\n      gameCubeData.names.push( piece.name );\n      gameCubeData.positions.push( piece.position );\n      gameCubeData.rotations.push( piece.rotation.toVector3() );\n\n    } );\n\n    localStorage.setItem( 'theCube_playing', gameInProgress );\n    localStorage.setItem( 'theCube_savedState', JSON.stringify( gameCubeData ) );\n    localStorage.setItem( 'theCube_time', gameTime );\n\n  }\n\n  clearGame() { //清除游戏数据\n\n    localStorage.removeItem( 'theCube_playing' );\n    localStorage.removeItem( 'theCube_savedState' );\n    localStorage.removeItem( 'theCube_time' );\n\n  }\n\n  loadScores() {\n\n    try {\n\n      const scoresData = JSON.parse( localStorage.getItem( 'theCube_scores' ) );\n\n      if ( ! scoresData ) throw new Error();\n\n      this.game.scores.data = scoresData;\n\n    } catch( e ) {}\n\n  }\n\n  saveScores() {\n\n    const scoresData = this.game.scores.data;\n\n    localStorage.setItem( 'theCube_scores', JSON.stringify( scoresData ) );\n\n  }\n\n  clearScores() {\n\n    localStorage.removeItem( 'theCube_scores' );\n\n  }\n\n  migrateScores() {\n\n    try {\n\n      const scoresData = JSON.parse( localStorage.getItem( 'theCube_scoresData' ) );\n      const scoresBest = parseInt( localStorage.getItem( 'theCube_scoresBest' ) );\n      const scoresWorst = parseInt( localStorage.getItem( 'theCube_scoresWorst' ) );\n      const scoresSolves = parseInt( localStorage.getItem( 'theCube_scoresSolves' ) );\n\n      if ( ! scoresData || ! scoresBest || ! scoresSolves || ! scoresWorst ) return false;\n\n      this.game.scores.data[ 3 ].scores = scoresData;\n      this.game.scores.data[ 3 ].best = scoresBest;\n      this.game.scores.data[ 3 ].solves = scoresSolves;\n      this.game.scores.data[ 3 ].worst = scoresWorst;\n\n      localStorage.removeItem( 'theCube_scoresData' );\n      localStorage.removeItem( 'theCube_scoresBest' );\n      localStorage.removeItem( 'theCube_scoresWorst' );\n      localStorage.removeItem( 'theCube_scoresSolves' );\n\n    } catch( e ) {}\n\n  }\n\n  loadPreferences() {\n\n    try {\n\n      const preferences = JSON.parse( localStorage.getItem( 'theCube_preferences' ) );\n\n      if ( ! preferences ) throw new Error();\n\n      this.game.cube.size = parseInt( preferences.cubeSize );\n      this.game.controls.flipConfig = parseInt( preferences.flipConfig );\n      this.game.scrambler.dificulty = parseInt( preferences.dificulty );\n\n      this.game.world.fov = parseFloat( preferences.fov );\n      this.game.world.resize();\n\n      this.game.themes.colors = preferences.colors;\n      this.game.themes.setTheme( preferences.theme );\n\n      return true;\n\n    } catch (e) {\n\n      this.game.cube.size = 3;\n      this.game.controls.flipConfig = 0;\n      this.game.scrambler.dificulty = 1;\n\n      this.game.world.fov = 10;\n      this.game.world.resize();\n\n      this.game.themes.setTheme( 'cube' );\n\n      this.savePreferences();\n\n      return false;\n\n    }\n\n  }\n\n  savePreferences() {\n\n    const preferences = {\n      cubeSize: this.game.cube.size,\n      flipConfig: this.game.controls.flipConfig,\n      dificulty: this.game.scrambler.dificulty,\n      fov: this.game.world.fov,\n      theme: this.game.themes.theme,\n      colors: this.game.themes.colors,\n    };\n\n    localStorage.setItem( 'theCube_preferences', JSON.stringify( preferences ) );\n\n  }\n\n  clearPreferences() {\n\n    localStorage.removeItem( 'theCube_preferences' );\n\n  }\n\n}\n\nexport { Storage };\n","class Themes {\n\n  constructor( game ) {\n\n    this.game = game;\n    this.theme = null;\n\n    this.defaults = {\n      cube: {\n        U: 0xfff7ff, // white\n        D: 0xffef48, // yellow\n        F: 0xef3923, // red\n        R: 0x41aac8, // blue\n        B: 0xff8c0a, // orange\n        L: 0x82ca38, // green\n        P: 0x08101a, // piece\n        G: 0xd1d5db, // background\n      },\n      erno: {\n        U: 0xffffff,\n        D: 0xffd500,\n        F: 0xc41e3a,\n        R: 0x0051ba,\n        B: 0xff5800,\n        L: 0x009e60,\n        P: 0x08101a,\n        G: 0x8abdff,\n      },\n      dust: {\n        U: 0xfff6eb,\n        D: 0xe7c48d,\n        F: 0x8f253e,\n        R: 0x607e69,\n        B: 0xbe6f62,\n        L: 0x849f5d,\n        P: 0x08101a,\n        G: 0xE7C48D,\n      },\n      camo: {\n        U: 0xfff6eb,\n        D: 0xbfb672,\n        F: 0x37241c,\n        R: 0x718456,\n        B: 0x805831,\n        L: 0x37431d,\n        P: 0x08101a,\n        G: 0xBFB672,\n      },\n      rain: {\n        U: 0xfafaff,\n        D: 0xedb92d,\n        F: 0xce2135,\n        R: 0x449a89,\n        B: 0xec582f,\n        L: 0xa3a947,\n        P: 0x08101a,\n        G: 0x87b9ac,\n      },\n    };\n\n    this.colors = JSON.parse( JSON.stringify( this.defaults ) );\n\n  }\n\n  getColors() {\n\n    return this.colors[ this.theme ];\n\n  }\n\n  setTheme( theme = false, force = false ) {\n\n    if ( theme === this.theme && force === false ) return;\n    if ( theme !== false ) this.theme = theme;\n\n    const colors = this.getColors();\n\n    this.game.dom.prefs.querySelectorAll( '.range__handle div' ).forEach( range => {\n\n      range.style.background = '#' + colors.R.toString(16).padStart(6, '0');\n\n    } );\n\n    this.game.cube.updateColors( colors );\n\n    this.game.confetti.updateColors( colors );\n\n    this.game.dom.back.style.background = '#' + colors.G.toString(16).padStart(6, '0');\n\n  }\n\n}\n\nexport { Themes };\n","import { Tween, Easing } from './utils/Tween.js';\n\nclass ThemeEditor {\n\n  constructor( game ) {\n\n    this.game = game;\n\n    this.editColor = 'R';\n\n    this.getPieceColor = this.getPieceColor.bind( this );\n\n  }\n\n  colorFromHSL( h, s, l ) {\n\n    h = Math.round( h );\n    s = Math.round( s );\n    l = Math.round( l );\n\n    return new THREE.Color( `hsl(${h}, ${s}%, ${l}%)` );\n\n  }\n\n  setHSL( color = null, animate = false ) {\n\n    this.editColor = ( color === null) ? 'R' : color;\n\n    const hsl = new THREE.Color( this.game.themes.getColors()[ this.editColor ] );\n\n    const { h, s, l } = hsl.getHSL( hsl );\n    const { hue, saturation, lightness } = this.game.preferences.ranges;\n\n    if ( animate ) {\n\n      const ho = hue.value / 360;\n      const so = saturation.value / 100;\n      const lo = lightness.value / 100;\n\n      const colorOld = this.colorFromHSL( hue.value, saturation.value, lightness.value );\n\n      if ( this.tweenHSL ) this.tweenHSL.stop()\n\n      this.tweenHSL = new Tween( {\n        duration: 200,\n        easing: Easing.Sine.Out(),\n        onUpdate: tween => {\n\n          hue.setValue( ( ho + ( h - ho ) * tween.value ) * 360 );\n          saturation.setValue( ( so + ( s - so ) * tween.value ) * 100 );\n          lightness.setValue( ( lo + ( l - lo ) * tween.value ) * 100 );\n\n          const colorTween = colorOld.clone().lerp( hsl, tween.value );\n\n          const colorTweenStyle = colorTween.getStyle();\n          const colorTweenHex = colorTween.getHSL( colorTween );\n\n          hue.handle.style.color = colorTweenStyle;\n          saturation.handle.style.color = colorTweenStyle;\n          lightness.handle.style.color = colorTweenStyle;\n\n          saturation.track.style.color =\n            this.colorFromHSL( colorTweenHex.h * 360, 100, 50 ).getStyle();\n          lightness.track.style.color =\n            this.colorFromHSL( colorTweenHex.h * 360, colorTweenHex.s * 100, 50 ).getStyle();\n\n          this.game.dom.theme.style.display = 'none';\n          this.game.dom.theme.offsetHeight;\n          this.game.dom.theme.style.display = '';\n\n        },\n        onComplete: () => {\n\n          this.updateHSL();\n          this.game.storage.savePreferences();\n\n        },\n      } );\n\n    } else {\n\n      hue.setValue( h * 360 );\n      saturation.setValue( s * 100 );\n      lightness.setValue( l * 100 );\n\n      this.updateHSL();\n      this.game.storage.savePreferences();\n\n    }\n\n  }\n\n  updateHSL() {\n\n    const { hue, saturation, lightness } = this.game.preferences.ranges;\n\n    const h = hue.value;\n    const s = saturation.value;\n    const l = lightness.value;\n\n    const color = this.colorFromHSL( h, s, l ).getStyle();\n\n    hue.handle.style.color = color;\n    saturation.handle.style.color = color;\n    lightness.handle.style.color = color;\n\n    saturation.track.style.color = this.colorFromHSL( h, 100, 50 ).getStyle();\n    lightness.track.style.color = this.colorFromHSL( h, s, 50 ).getStyle();\n\n    this.game.dom.theme.style.display = 'none';\n    this.game.dom.theme.offsetHeight;\n    this.game.dom.theme.style.display = '';\n\n    const theme = this.game.themes.theme;\n\n    this.game.themes.colors[ theme ][ this.editColor ] = this.colorFromHSL( h, s, l ).getHex();\n    this.game.themes.setTheme();\n\n  }\n\n  colorPicker( enable ) {\n\n    if ( enable ) {\n\n      this.game.dom.game.addEventListener( 'click', this.getPieceColor, false );\n\n    } else {\n\n      this.game.dom.game.removeEventListener( 'click', this.getPieceColor, false );\n\n    }\n\n  }\n\n  getPieceColor( event ) {\n\n    const clickEvent = event.touches\n      ? ( event.touches[ 0 ] || event.changedTouches[ 0 ] )\n      : event;\n\n    const clickPosition = new THREE.Vector2( clickEvent.pageX, clickEvent.pageY );\n\n    let edgeIntersect = this.game.controls.getIntersect( clickPosition, this.game.cube.edges, true );\n    let pieceIntersect = this.game.controls.getIntersect( clickPosition, this.game.cube.cubes, true );\n\n    if ( edgeIntersect !== false ) {\n\n      const edge = edgeIntersect.object;\n\n      const position = edge.parent\n        .localToWorld( edge.position.clone() )\n        .sub( this.game.cube.object.position )\n        .sub( this.game.cube.animator.position );\n\n      const mainAxis = this.game.controls.getMainAxis( position );\n      if ( position.multiplyScalar( 2 ).round()[ mainAxis ] < 1 ) edgeIntersect = false;\n\n    }\n\n    const name = edgeIntersect ? edgeIntersect.object.name : pieceIntersect ? 'P' : 'G';\n\n    this.setHSL( name, true );\n\n  }\n\n  resetTheme() {\n\n    this.game.themes.colors[ this.game.themes.theme ] =\n      JSON.parse( JSON.stringify( this.game.themes.defaults[ this.game.themes.theme ] ) );\n\n    this.game.themes.setTheme();\n\n    this.setHSL( this.editColor, true );\n\n  }\n\n}\n\nexport { ThemeEditor };","const States = {\n  3: {\n    checkerboard: {\n      names: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26 ],\n      positions: [\n        { \"x\": 1/3, \"y\": -1/3, \"z\": 1/3 },\n        { \"x\": -1/3, \"y\": 1/3, \"z\": 0 },\n        { \"x\": 1/3, \"y\": -1/3, \"z\": -1/3 },\n        { \"x\": -1/3, \"y\": 0, \"z\": -1/3 },\n        { \"x\": 1/3, \"y\": 0, \"z\": 0 },\n        { \"x\": -1/3, \"y\": 0, \"z\": 1/3 },\n        { \"x\": 1/3, \"y\": 1/3, \"z\": 1/3 },\n        { \"x\": -1/3, \"y\": -1/3, \"z\": 0 },\n        { \"x\": 1/3, \"y\": 1/3, \"z\": -1/3 },\n        { \"x\": 0, \"y\": 1/3, \"z\": -1/3 },\n        { \"x\": 0, \"y\": -1/3, \"z\": 0 },\n        { \"x\": 0, \"y\": 1/3, \"z\": 1/3 },\n        { \"x\": 0, \"y\": 0, \"z\": 1/3 },\n        { \"x\": 0, \"y\": 0, \"z\": 0 },\n        { \"x\": 0, \"y\": 0, \"z\": -1/3 },\n        { \"x\": 0, \"y\": -1/3, \"z\": -1/3 },\n        { \"x\": 0, \"y\": 1/3, \"z\": 0 },\n        { \"x\": 0, \"y\": -1/3, \"z\": 1/3 },\n        { \"x\": -1/3, \"y\": -1/3, \"z\": 1/3 },\n        { \"x\": 1/3, \"y\": 1/3, \"z\": 0 },\n        { \"x\": -1/3, \"y\": -1/3, \"z\": -1/3 },\n        { \"x\": 1/3, \"y\": 0, \"z\": -1/3 },\n        { \"x\": -1/3, \"y\": 0, \"z\": 0 },\n        { \"x\": 1/3, \"y\": 0, \"z\": 1/3 },\n        { \"x\": -1/3, \"y\": 1/3, \"z\": 1/3 },\n        { \"x\": 1/3, \"y\": -1/3, \"z\": 0 },\n        { \"x\": -1/3, \"y\": 1/3, \"z\": -1/3 }\n      ],\n      rotations: [\n        { \"x\": -Math.PI, \"y\": 0, \"z\": Math.PI, },\n        { \"x\": Math.PI, \"y\": 0, \"z\": 0 },\n        { \"x\": -Math.PI, \"y\": 0, \"z\": Math.PI },\n        { \"x\": 0, \"y\": 0, \"z\": 0 },\n        { \"x\": 0, \"y\": 0, \"z\": Math.PI },\n        { \"x\": 0, \"y\": 0, \"z\": 0 },\n        { \"x\": -Math.PI, \"y\": 0, \"z\": Math.PI },\n        { \"x\": Math.PI, \"y\": 0, \"z\": 0 },\n        { \"x\": -Math.PI, \"y\": 0, \"z\": Math.PI },\n        { \"x\": 0, \"y\": 0, \"z\": Math.PI },\n        { \"x\": 0, \"y\": 0, \"z\": 0 },\n        { \"x\": 0, \"y\": 0, \"z\": Math.PI },\n        { \"x\": -Math.PI, \"y\": 0, \"z\": 0 },\n        { \"x\": Math.PI, \"y\": 0, \"z\": Math.PI },\n        { \"x\": Math.PI, \"y\": 0, \"z\": 0 },\n        { \"x\": 0, \"y\": 0, \"z\": Math.PI },\n        { \"x\": 0, \"y\": 0, \"z\": 0 },\n        { \"x\": 0, \"y\": 0, \"z\": Math.PI },\n        { \"x\": Math.PI, \"y\": 0, \"z\": Math.PI },\n        { \"x\": -Math.PI, \"y\": 0, \"z\": 0 },\n        { \"x\": Math.PI, \"y\": 0, \"z\": Math.PI },\n        { \"x\": 0, \"y\": 0, \"z\": 0 },\n        { \"x\": 0, \"y\": 0, \"z\": Math.PI },\n        { \"x\": 0, \"y\": 0, \"z\": 0 },\n        { \"x\": Math.PI, \"y\": 0, \"z\": Math.PI },\n        { \"x\": -Math.PI, \"y\": 0, \"z\": 0 },\n        { \"x\": Math.PI, \"y\": 0, \"z\": Math.PI }\n      ],\n      size: 3,\n    },\n  }\n};\n\nexport { States };","class IconsConverter {\n\n\tconstructor(options) {\n\n\t\toptions = Object.assign({\n\t\t\ttagName: 'icon',\n\t\t\tclassName: 'icon',\n\t\t\tstyles: false,\n\t\t\ticons: {},\n\t\t\tobserve: false,\n\t\t\tconvert: false,\n\t\t}, options || {});\n\n\t\tthis.tagName = options.tagName;\n\t\tthis.className = options.className;\n\t\tthis.icons = options.icons;\n\n\t\tthis.svgTag = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n\t\tthis.svgTag.setAttribute('class', this.className);\n\n\t\tif (options.styles) this.addStyles();\n\t\tif (options.convert) this.convertAllIcons();\n\n\t\tif (options.observe) {\n\n\t\t\tconst MutationObserver = window.MutationObserver || window.WebKitMutationObserver;\n\t\t\tthis.observer = new MutationObserver(mutations => { this.convertAllIcons(); });\n\t\t\tthis.observer.observe(document.documentElement, { childList: true, subtree: true });\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tconvertAllIcons() {\n\n\t\tdocument.querySelectorAll(this.tagName).forEach(icon => { this.convertIcon(icon); });\n\n\t}\n\n\tconvertIcon(icon) {\n\n\t\tconst svgData = this.icons[icon.attributes[0].localName];\n\n\t\tif (typeof svgData === 'undefined') return;\n\n\t\tconst svg = this.svgTag.cloneNode(true);\n\t\tconst viewBox = svgData.viewbox.split(' ');\n\n\t\tsvg.setAttributeNS(null, 'viewBox', svgData.viewbox);\n\t\tsvg.style.width = viewBox[2] / viewBox[3] + 'em';\n\t\tsvg.style.height = '1em';\n\t\tsvg.innerHTML = svgData.content;\n\n\t\ticon.parentNode.replaceChild(svg, icon);\n\n\t}\n\n\taddStyles() {\n\n\t\tconst style = document.createElement('style');\n\t\tstyle.innerHTML = `.${this.className} { display: inline-block; font-size: inherit; overflow: visible; vertical-align: -0.125em; preserveAspectRatio: none; }`;\n\t\tdocument.head.appendChild(style);\n\n\t}\n\n}\n\nconst Icons = new IconsConverter({\n\n\ticons: {\n\t\tsettings: {\n\t\t\tviewbox: '0 0 512 512',\n\t\t\tcontent: '<path fill=\"currentColor\" d=\"M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z\" />',\n\t\t},\n\t\tback: {\n\t\t\tviewbox: '0 0 512 512',\n\t\t\tcontent: '<path transform=\"translate(512, 0) scale(-1,1)\" fill=\"currentColor\" d=\"M503.691 189.836L327.687 37.851C312.281 24.546 288 35.347 288 56.015v80.053C127.371 137.907 0 170.1 0 322.326c0 61.441 39.581 122.309 83.333 154.132 13.653 9.931 33.111-2.533 28.077-18.631C66.066 312.814 132.917 274.316 288 272.085V360c0 20.7 24.3 31.453 39.687 18.164l176.004-152c11.071-9.562 11.086-26.753 0-36.328z\" />',\n\t\t},\n\t\ttrophy: {\n\t\t\tviewbox: '0 0 576 512',\n\t\t\tcontent: '<path fill=\"currentColor\" d=\"M552 64H448V24c0-13.3-10.7-24-24-24H152c-13.3 0-24 10.7-24 24v40H24C10.7 64 0 74.7 0 88v56c0 66.5 77.9 131.7 171.9 142.4C203.3 338.5 240 360 240 360v72h-48c-35.3 0-64 20.7-64 56v12c0 6.6 5.4 12 12 12h296c6.6 0 12-5.4 12-12v-12c0-35.3-28.7-56-64-56h-48v-72s36.7-21.5 68.1-73.6C498.4 275.6 576 210.3 576 144V88c0-13.3-10.7-24-24-24zM64 144v-16h64.2c1 32.6 5.8 61.2 12.8 86.2-47.5-16.4-77-49.9-77-70.2zm448 0c0 20.2-29.4 53.8-77 70.2 7-25 11.8-53.6 12.8-86.2H512v16zm-127.3 4.7l-39.6 38.6 9.4 54.6c1.7 9.8-8.7 17.2-17.4 12.6l-49-25.8-49 25.8c-8.8 4.6-19.1-2.9-17.4-12.6l9.4-54.6-39.6-38.6c-7.1-6.9-3.2-19 6.7-20.5l54.8-8 24.5-49.6c4.4-8.9 17.1-8.9 21.5 0l24.5 49.6 54.8 8c9.6 1.5 13.5 13.6 6.4 20.5z\" />',\n\t\t},\n\t\tcancel: {\n\t\t\tviewbox: '0 0 352 512',\n\t\t\tcontent: '<path fill=\"currentColor\" d=\"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z\" />',\n\t\t},\n\t\ttheme: {\n\t\t\tviewbox: '0 0 512 512',\n\t\t\tcontent: '<path fill=\"currentColor\" d=\"M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z\"/>',\n\t\t},\n\t\treset: {\n\t\t\tviewbox: '0 0 512 512',\n\t\t\tcontent: '<path fill=\"currentColor\" d=\"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z\" />',\n\t\t},\n\t\ttrash: {\n\t\t\tviewbox: '0 0 448 512',\n\t\t\tcontent: '<path fill=\"currentColor\" d=\"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z\" />',\n\t\t},\n\t},\n\n\tconvert: true,\n\n});\n\nexport { Icons };\n","import { World } from './World.js';\nimport { Cube } from './Cube.js';\nimport { Controls } from './Controls.js';\nimport { Scrambler } from './Scrambler.js';\nimport { Transition } from './Transition.js';\nimport { Timer } from './Timer.js';\nimport { Preferences } from './Preferences.js';\nimport { Confetti } from './Confetti.js';\nimport { Scores } from './Scores.js';\nimport { Storage } from './Storage.js';\nimport { Themes } from './Themes.js';\nimport { ThemeEditor } from './ThemeEditor.js';\nimport { States } from './States.js';\nimport { Icons } from './Icons.js';\n\nconst STATE = {\n  Menu: 0,\n  Playing: 1,\n  Complete: 2,\n  Stats: 3,\n  Prefs: 4,\n  Theme: 5,\n};\n\nconst BUTTONS = {\n  Menu: ['stats', 'prefs'],\n  Playing: ['back', 'resetcube'],\n  Complete: [],\n  Stats: ['back', 'clearscore'],\n  Prefs: ['back', 'theme', 'musicico'],\n  Theme: ['back', 'reset'],\n  None: [],\n};\n\nconst SHOW = true;\nconst HIDE = false;\n\nclass Game {\n\n  constructor() {\n\n    this.dom = {\n      ui: document.querySelector('.ui'), //返回匹配指定CSS选择器的元素\n      game: document.querySelector('.ui__game'),\n      back: document.querySelector('.ui__background'),\n      prefs: document.querySelector('.ui__prefs'),\n      theme: document.querySelector('.ui__theme'),\n      stats: document.querySelector('.ui__stats'),\n      // musicico: document.querySelector('.musicico'),\n      texts: {\n        title: document.querySelector('.text--title'),\n        note: document.querySelector('.text--note'),\n        timer: document.querySelector('.text--timer'),\n        complete: document.querySelector('.text--complete'),\n        best: document.querySelector('.text--best-time'),\n        theme: document.querySelector('.text--theme'),\n      },\n      buttons: {\n        prefs: document.querySelector('.btn--prefs'),\n        back: document.querySelector('.btn--back'),\n        stats: document.querySelector('.btn--stats'),\n        reset: document.querySelector('.btn--reset'),\n        theme: document.querySelector('.btn--theme'),\n        resetcube: document.querySelector('.btn--resetcube'),\n        clearscore: document.querySelector('.btn--clearscore'),\n        musicico: document.querySelector('.btn--musicico'),\n      },\n    };\n\n    this.world = new World(this);\n    this.cube = new Cube(this);\n    this.controls = new Controls(this);\n    this.scrambler = new Scrambler(this);\n    this.transition = new Transition(this);\n    this.timer = new Timer(this);\n    this.preferences = new Preferences(this);\n    this.scores = new Scores(this);\n    this.storage = new Storage(this);\n    this.confetti = new Confetti(this);\n    this.themes = new Themes(this);\n    this.themeEditor = new ThemeEditor(this);\n\n    this.initActions(); // 点击两下开始游戏\n    // 撒花\n    // this.confetti.start();\n\n    this.state = STATE.Menu;\n    this.newGame = false;\n    this.saved = false;\n\n    this.storage.init();\n    this.preferences.init();\n    this.cube.init();\n    this.transition.init();\n\n    this.storage.loadGame(); //加载本地游戏数据\n    this.scores.calcStats(); //计算统计分数\n\n    setTimeout(() => { //最开始界面\n\n      this.transition.float();\n      this.transition.cube(SHOW); //魔方掉下来\n\n      setTimeout(() => this.transition.title(SHOW), 0);\n      setTimeout(() => this.transition.buttons(BUTTONS.Menu, BUTTONS.None), 500);\n\n    }, 500);\n\n  }\n\n  initActions() { //点击两下开始游戏\n    let tappedTwice = false; //初始化\n    this.dom.game.addEventListener('click', event => {\n\n      if (this.transition.activeTransitions > 0) return;\n      if (this.state === STATE.Playing) return;\n\n      if (this.state === STATE.Menu) {\n\n        if (!tappedTwice) {\n\n          tappedTwice = true;\n          setTimeout(() => tappedTwice = false, 300);\n          return false;\n\n        }\n\n        this.game(SHOW); //进入游戏\n\n      } else if (this.state === STATE.Complete) {\n\n        this.complete(HIDE); //完成的数据图标隐藏\n\n      } else if (this.state === STATE.Stats) {\n\n        this.stats(HIDE); //奖杯数据图标隐藏\n\n      }\n\n    }, false);\n    // 魔方转动一下即开始计时\n    this.controls.onMove = () => {\n      if (this.newGame) {\n\n        this.timer.start(true);\n        this.newGame = false;\n\n      }\n\n    }\n    // 返回按钮\n    this.dom.buttons.back.onclick = event => {\n\n      if (this.transition.activeTransitions > 0) return;\n\n      if (this.state === STATE.Playing) {\n\n        this.game(HIDE); //游戏隐藏\n\n      } else if (this.state === STATE.Prefs) {\n\n        this.prefs(HIDE);\n\n      } else if (this.state === STATE.Theme) {\n\n        this.theme(HIDE);\n\n      } else if (this.state === STATE.Stats) {\n\n        this.stats(HIDE);\n\n      }\n\n    };\n    //重置主题配色\n    this.dom.buttons.reset.onclick = event => {\n\n      if (this.state === STATE.Theme) {\n\n        this.themeEditor.resetTheme();\n\n      }\n\n    };\n    //还原魔方\n    this.dom.buttons.resetcube.onclick = event => {\n      const ok = window.confirm(\"注意：还原后时间照常流逝，再次打乱并还原之后视为成功还原！\");\n      if (ok) {\n        this.cube.reset();\n        this.cube.init();\n      }\n\n    };\n\n    this.dom.buttons.clearscore.onclick = event => {\n      const ok = window.confirm(\"确定要清除成绩数据吗？\");\n      if (ok) {\n        this.scores.clearStats();\n      }\n\n    };\n    // 动画旋转\n    var music = document.getElementById('music')    //获取音乐\n    var musicimg = document.getElementById('musicimg')   //获取音乐图标\n    var tem = false  //设置一个变量，用来控制音乐是否在播放。\n    musicimg.style = 'animation-play-state: paused';\n    // musicimg.style.animationPlayState = 'paused'  //暂停音乐图标\n\n    this.dom.buttons.musicico.onclick = event => {\n\n      //定义一个函数，当用户单击的时候触发这个函数，从而实现音乐的暂停与播放。\n      //tem用来控制音乐当前是否在播放。true代表音乐正在播放，false代表音乐当前正在处于暂停的状态。\n      if (tem == false) {\n        music.play()  //播放音乐\n        tem = true\n        // musicimg.style.animationPlayState = 'running'  //播放音乐图标\n        musicimg.style = 'animation-play-state: running';\n      } else {\n        music.pause()  //暂停音乐\n        tem = false\n        // musicimg.style.animationPlayState = 'paused'  //暂停音乐图标\n        musicimg.style = 'animation-play-state: paused';\n      }\n\n    };\n\n    this.dom.buttons.prefs.onclick = event => this.prefs(SHOW); //参数配置\n\n    this.dom.buttons.theme.onclick = event => this.theme(SHOW); //主题设置\n\n    this.dom.buttons.stats.onclick = event => this.stats(SHOW); //数据展示\n\n    this.controls.onSolved = () => this.complete(SHOW); //复原魔方之后展示完成界面\n\n  }\n\n  game(show) { //进入游戏\n\n    if (show) {\n\n      if (!this.saved) {\n        // 随机打乱魔方\n        this.scrambler.scramble();\n        this.controls.scrambleCube();\n        this.newGame = true;\n\n      }\n      // 魔方阶数越大，转动速度设置更快\n      const duration = this.saved ? 0 :\n        this.scrambler.converted.length * (this.controls.flipSpeeds[0] + 10);\n\n      this.state = STATE.Playing;\n      this.saved = true; //保存现在打乱的状态\n\n      this.transition.buttons(BUTTONS.None, BUTTONS.Menu);\n\n      // this.transition.zoom( STATE.Playing, duration ); //魔方整体旋转着打乱\n      this.transition.title(HIDE);\n\n      setTimeout(() => {\n\n        this.transition.timer(SHOW);\n        this.transition.buttons(BUTTONS.Playing, BUTTONS.None); //返回键,重置键\n\n      }, this.transition.durations.zoom - 1000); //在指定时间后执行一次指定函数\n\n      setTimeout(() => {\n\n        this.controls.enable(); //能控制转动\n        if (!this.newGame) this.timer.start(true) //开始转第一次即为newGame，然后开始计时\n\n      }, this.transition.durations.zoom);\n\n    } else {\n\n      this.state = STATE.Menu;\n\n      this.transition.buttons(BUTTONS.Menu, BUTTONS.Playing);//暂停界面\n\n      this.transition.zoom(STATE.Menu, 0);\n\n      this.controls.disable();\n      if (!this.newGame) this.timer.stop();\n      this.transition.timer(HIDE);\n\n      setTimeout(() => this.transition.title(SHOW), this.transition.durations.zoom - 1000);\n\n      this.playing = false;\n      this.controls.disable();\n\n    }\n\n  }\n\n  prefs(show) { //设置参数\n\n    if (show) {\n\n      if (this.transition.activeTransitions > 0) return;\n\n      this.state = STATE.Prefs;\n\n      this.transition.buttons(BUTTONS.Prefs, BUTTONS.Menu);//参数界面返回和主题按钮显示，成绩和参数按钮隐藏\n\n      this.transition.title(HIDE);\n      this.transition.cube(HIDE);\n\n      setTimeout(() => this.transition.preferences(SHOW), 500);\n\n    } else {\n\n      this.cube.resize();\n\n      this.state = STATE.Menu;\n\n      this.transition.buttons(BUTTONS.Menu, BUTTONS.Prefs);\n\n      this.transition.preferences(HIDE);\n\n      setTimeout(() => this.transition.cube(SHOW), 500);\n      setTimeout(() => this.transition.title(SHOW), 1200);\n\n    }\n\n  }\n\n  theme(show) { //魔方主题设置\n\n    this.themeEditor.colorPicker(show);\n\n    if (show) {\n\n      if (this.transition.activeTransitions > 0) return;\n\n      this.cube.loadFromData(States['3']['checkerboard']);\n\n      this.themeEditor.setHSL(null, false);\n\n      this.state = STATE.Theme;\n\n      this.transition.buttons(BUTTONS.Theme, BUTTONS.Prefs);\n\n      this.transition.preferences(HIDE);\n\n      setTimeout(() => this.transition.cube(SHOW, true), 500);\n      setTimeout(() => this.transition.theming(SHOW), 1000);\n\n    } else {\n\n      this.state = STATE.Prefs;\n\n      this.transition.buttons(BUTTONS.Prefs, BUTTONS.Theme);\n\n      this.transition.cube(HIDE, true);\n      this.transition.theming(HIDE);\n\n      setTimeout(() => this.transition.preferences(SHOW), 1000);\n      setTimeout(() => {\n\n        const gameCubeData = JSON.parse(localStorage.getItem('theCube_savedState'));\n\n        if (!gameCubeData) {\n\n          this.cube.resize(true);\n          return;\n\n        }\n\n        this.cube.loadFromData(gameCubeData);\n\n      }, 1500);\n\n    }\n\n  }\n\n  stats(show) { //奖杯数据界面\n\n    if (show) {\n\n      if (this.transition.activeTransitions > 0) return;\n\n      this.state = STATE.Stats;\n      //BUTTONS.Stats设成空值，虽然是show但是也没有按钮,Menu包括了数据和参数两个按钮（隐藏）\n      this.transition.buttons(BUTTONS.Stats, BUTTONS.Menu);\n\n      this.transition.title(HIDE); //标题隐藏（标题删了...\n      this.transition.cube(HIDE); //魔方隐藏\n\n      setTimeout(() => this.transition.stats(SHOW), 500); //0.5秒之后数据界面随之出现\n\n    } else {\n\n      this.state = STATE.Menu;\n\n      this.transition.buttons(BUTTONS.Menu, BUTTONS.Stats);\n\n      this.transition.stats(HIDE); //数据界面隐藏\n\n      setTimeout(() => this.transition.cube(SHOW), 500); //0.5秒时候魔方显示\n      setTimeout(() => this.transition.title(SHOW), 1200);\n\n    }\n\n  }\n\n  complete(show) { //通关游戏\n\n    if (show) {\n\n      this.transition.buttons(BUTTONS.Complete, BUTTONS.Playing); //返回键隐藏\n\n      this.state = STATE.Complete;\n      this.saved = false; //保存的魔方状态\n\n      this.controls.disable(); //禁止控制\n      this.timer.stop(); //时间停止\n      this.storage.clearGame(); //清除游戏的缓存数据\n\n      this.bestTime = this.scores.addScore(this.timer.deltaTime); //时间处理\n\n      this.transition.zoom(STATE.Menu, 0); //魔方整体旋转\n      this.transition.elevate(SHOW); //text--complete恭喜完成\n\n      setTimeout(() => {\n\n        this.transition.complete(SHOW, this.bestTime)\n        this.confetti.start(); //五彩纸屑\n\n      }, 1000);\n\n    } else {\n\n      this.state = STATE.Stats;\n      this.saved = false;\n\n      this.transition.timer(HIDE);\n      this.transition.complete(HIDE, this.bestTime);\n      this.transition.cube(HIDE);\n      this.timer.reset();\n\n      setTimeout(() => {\n\n        this.cube.reset();\n        this.confetti.stop();\n\n        this.transition.stats(SHOW) //成绩\n        this.transition.elevate(0);\n\n      }, 1000);\n\n      return false;\n\n    }\n\n  }\n\n}\n\nwindow.game = new Game();\n"],"names":["animationEngine","uniqueID","constructor","this","ids","animations","update","bind","raf","time","now","performance","delta","i","length","requestAnimationFrame","add","animation","id","push","remove","index","indexOf","splice","Animation","start","stop","World","game","super","container","dom","scene","THREE","Scene","renderer","WebGLRenderer","antialias","alpha","setPixelRatio","window","devicePixelRatio","appendChild","domElement","camera","PerspectiveCamera","stage","width","height","fov","createLights","onResize","resize","addEventListener","render","offsetWidth","offsetHeight","setSize","aspect","fovRad","Math","DEG2RAD","distance","tan","position","set","lookAt","updateProjectionMatrix","docFontSize","document","documentElement","style","fontSize","forEach","cb","lights","holder","Object3D","ambient","AmbientLight","front","DirectionalLight","back","RoundedBoxGeometry","size","radius","radiusSegments","depth","BufferGeometry","call","type","isNaN","max","floor","edgeHalfWidth","min","edgeHalfHeight","edgeHalfDepth","parameters","rs1","totalVertexCount","positions","BufferAttribute","Float32Array","normals","cornerVerts","cornerNormals","Vector3","a","b","c","d","vertex","vertexPool","normalPool","indices","lastVertex","cornerVertNumber","cornerLayout","j","PIhalf","PI","cornerOffset","y","va","cosVa","cos","sinVa","sin","x","ha","z","vert","clone","multiplyScalar","norm","normalize","multiply","doVertices","flips","lastRowOffset","v","r1","r2","u","u1","doCorners","cOffset","cRowOffset","needsFlip","doHeightEdges","end","cStarts","cEnds","cStart","cEnd","doWidthEdges","urs1","u1rs1","doDepthEdges","setXYZ","setIndex","Uint16Array","addAttribute","prototype","Object","create","Cube","geometry","pieceCornerRadius","edgeCornerRoundness","edgeScale","edgeDepth","object","animator","world","init","cubes","children","controls","group","scale","controlsScale","edges","generatePositions","generateModel","pieces","piece","userData","cube","traverse","node","frustumCulled","updateColors","themes","getColors","sizeGenerated","force","preferences","ranges","value","reset","saved","timer","storage","clearGame","rotation","m","first","pieceSize","mainMaterial","MeshBasicMaterial","pieceMesh","Mesh","edgeGeometry","shape","Shape","moveTo","lineTo","quadraticCurveTo","ExtrudeBufferGeometry","bevelEnabled","curveSegments","RoundedPlaneGeometry","pieceCube","pieceEdges","copy","divideScalar","name","edgesName","edge","colors","material","color","setHex","P","loadFromData","data","names","rotations","Easing","In","power","round","t","pow","Out","abs","InOut","s","amplitude","period","PI2","p1","p2","p3","asin","Tween","options","duration","easing","onUpdate","onComplete","delay","yoyo","progress","getFromTo","setTimeout","old","direction","values","updateFromTo","updateYoyo","key","target","from","to","keys","event","preventDefault","passive","Draggable","element","current","Vector2","drag","assign","calcDelta","touch","which","touches","getPositionCurrent","onDragStart","move","sub","onDragMove","onDragEnd","removeEventListener","enable","disable","dragEvent","changedTouches","pageX","pageY","convertPosition","Controls","flipConfig","flipEasings","flipSpeeds","raycaster","Raycaster","helperMaterial","depthWrite","transparent","opacity","helper","PlaneBufferGeometry","BoxBufferGeometry","onSolved","onMove","momentum","scramble","state","enabled","initDraggable","draggable","gettingDrag","edgeIntersect","getIntersect","dragIntersect","dragNormal","face","normal","flipType","attach","translateZ","updateMatrixWorld","detach","planeIntersect","dragCurrent","worldToLocal","point","dragTotal","dragDelta","setZ","addMomentumPoint","dragDirection","getMainAxis","worldDirection","localToWorld","objectDirection","flipAxis","cross","negate","selectLayer","getLayer","axis","flipAngle","rotateOnAxis","rotateOnWorldAxis","getMomentum","roundAngle","sign","rotateLayer","layer","saveGame","checkIsSolved","rotateCube","callback","config","bounce","bounceCube","rotationTween","tween","deltaAngle","flipLayer","slice","setFromVector3","snapRotation","toVector3","deselectLayer","fixDelta","movePieces","applyMatrix","matrixWorld","Matrix4","getInverse","scalar","parent","keyboardMove","angle","scrambleCube","scrambler","converted","shift","multiple","setFromCamera","intersect","intersectObjects","intersectObject","vector","reduce","child","Date","filter","moment","points","solved","sides","mainAxis","mainSign","side","every","Scrambler","dificulty","scrambleLength","moves","conveted","pring","count","split","faces","modifiers","total","random","charAt","convert","print","join","convertedMove","convertMove","modifier","D","U","L","R","F","B","toUpperCase","row","toLowerCase","Transition","tweens","durations","cubeY","cameraZoom","activeTransitions","zoom","buttons","title","best","complete","prefs","theme","stats","show","hide","buttonTween","button","translate","transform","pointerEvents","theming","e","currentY","currentRotation","float","play","rotate","elevate","text","texts","querySelector","querySelectorAll","span","splitLetters","letters","flipLetters","scores","calcStats","tweenId","stat","listMax","range","rangeIndex","label","track","handle","list","listItem","labelIndex","note","parseFloat","getComputedStyle","setText","innerHTML","letter","createElement","Timer","continueGame","startTime","deltaTime","currentTime","millis","localStorage","setItem","seconds","parseInt","minutes","RangeHTML","el","temp","rangeLabel","rangeList","setAttribute","getAttribute","hasAttribute","classList","listItemText","parentNode","replaceChild","Range","step","setValue","limitValue","setHandlePosition","positionFromValue","left","limitPosition","valueFromPosition","percentsFromValue","Preferences","item","savePreferences","flip","erno","dust","camo","rain","setTheme","hue","themeEditor","updateHSL","saturation","lightness","Confetti","started","speed","revolution","PlaneGeometry","DoubleSide","holders","ConfettiStage","distanceFromCube","particles","resizeViewport","Particle","playing","completed","transition","confetti","velocity","mesh","randFloat","randomHeight","Color","revolutionSpeed","revolutionAxis","Scores","solves","worst","addScore","lenght","bestTime","saveScores","setStat","convertTime","getAverage","clearStats","Storage","userVersion","getItem","gameVersion","clearPreferences","migrateScores","loadPreferences","loadScores","loadGame","Error","gameCubeData","JSON","parse","gameTime","stringify","removeItem","scoresData","clearScores","scoresBest","scoresWorst","scoresSolves","cubeSize","Themes","defaults","G","background","toString","padStart","ThemeEditor","editColor","getPieceColor","colorFromHSL","h","l","setHSL","animate","hsl","getHSL","ho","so","lo","colorOld","tweenHSL","colorTween","lerp","colorTweenStyle","getStyle","colorTweenHex","display","getHex","colorPicker","clickEvent","clickPosition","pieceIntersect","resetTheme","States","checkerboard","tagName","className","styles","icons","observe","svgTag","createElementNS","addStyles","convertAllIcons","MutationObserver","WebKitMutationObserver","observer","mutations","childList","subtree","icon","convertIcon","svgData","attributes","localName","svg","cloneNode","viewBox","viewbox","setAttributeNS","content","head","settings","trophy","cancel","trash","STATE","BUTTONS","SHOW","HIDE","ui","resetcube","clearscore","musicico","initActions","newGame","tappedTwice","onclick","confirm","music","getElementById","musicimg","tem","pause"],"mappings":"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"}